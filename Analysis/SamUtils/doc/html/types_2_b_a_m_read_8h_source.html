<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>SamUtils: types/BAMRead.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript">
$(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.4 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="300px-Lightning_storm_over_Boston_-_NOAA.jpg"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">SamUtils</div>
   <div id="projectbrief">Utility classes for working with SAM/BAM files.  Also provides some basic quality utilities</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('types_2_b_a_m_read_8h.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">types/BAMRead.h</div>  </div>
</div>
<div class="contents">
<div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/* Copyright (C) 2010 Ion Torrent Systems, Inc. All Rights Reserved */</span>
<a name="l00002"></a>00002 
<a name="l00003"></a>00003 <span class="preprocessor">#ifndef BAMREAD_H</span>
<a name="l00004"></a>00004 <span class="preprocessor"></span><span class="preprocessor">#define BAMREAD_H</span>
<a name="l00005"></a>00005 <span class="preprocessor"></span>
<a name="l00006"></a>00006 <span class="comment">/*</span>
<a name="l00007"></a>00007 <span class="comment"> *  BAMRead.h</span>
<a name="l00008"></a>00008 <span class="comment"> *  SamUtils</span>
<a name="l00009"></a>00009 <span class="comment"> *</span>
<a name="l00010"></a>00010 <span class="comment"> *  Created by Michael Lyons on 12/21/10.</span>
<a name="l00011"></a>00011 <span class="comment"> *  </span>
<a name="l00012"></a>00012 <span class="comment"> *</span>
<a name="l00013"></a>00013 <span class="comment"> */</span>
<a name="l00014"></a>00014 
<a name="l00015"></a>00015 
<a name="l00016"></a>00016 <span class="comment">//TODO IDEAS</span>
<a name="l00017"></a>00017 <span class="comment">/*</span>
<a name="l00018"></a>00018 <span class="comment"> merge optional fields into 1 function with this signature</span>
<a name="l00019"></a>00019 <span class="comment"> get_optional_field(char&amp; type, char&amp; tag, void&amp; return_type)</span>
<a name="l00020"></a>00020 <span class="comment"> */</span>
<a name="l00021"></a>00021 
<a name="l00022"></a>00022 <span class="comment">//stl</span>
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;cassert&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;tr1/memory&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;string&gt;</span>
<a name="l00026"></a>00026 
<a name="l00027"></a>00027 <span class="comment">//project</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &quot;samutils_types.h&quot;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &quot;Cigar.h&quot;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &quot;Sequence.h&quot;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &quot;Qual.h&quot;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &quot;MD.h&quot;</span>
<a name="l00033"></a>00033 
<a name="l00034"></a>00034 <span class="comment">//3rd party</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &quot;sam.h&quot;</span>
<a name="l00036"></a>00036     
<a name="l00037"></a>00037 <span class="keyword">using namespace </span>samutils_types;
<a name="l00044"></a>00044 <span class="keyword">class </span><a class="code" href="class_b_a_m_read.html">BAMRead</a> {
<a name="l00045"></a>00045  
<a name="l00046"></a>00046  <span class="keyword">public</span>:
<a name="l00051"></a><a class="code" href="class_b_a_m_read.html#a2941b759b5655356a4ca02760dc6ca5e">00051</a>  <a class="code" href="class_b_a_m_read.html#a2941b759b5655356a4ca02760dc6ca5e">BAMRead</a>(): bam_record(), bam_header(NULL) {}
<a name="l00062"></a><a class="code" href="class_b_a_m_read.html#a946460d3c95417f5d7071afde2e9bdeb">00062</a>  <a class="code" href="class_b_a_m_read.html#a946460d3c95417f5d7071afde2e9bdeb">BAMRead</a>(bam1_t* BAM_read, <span class="keyword">const</span> bam_header_t* BAM_header): bam_record(bam_dup1(BAM_read), <a class="code" href="structsamutils__types_1_1bam__cleanup.html">bam_cleanup</a>() ), bam_header(BAM_header){}
<a name="l00070"></a><a class="code" href="class_b_a_m_read.html#ae60c749028e839956b8b256357e3aebf">00070</a>  <a class="code" href="class_b_a_m_read.html#ae60c749028e839956b8b256357e3aebf">BAMRead</a>(bam_ptr shared_bam_ptr, <span class="keyword">const</span> bam_header_t* BAM_header): bam_record(shared_bam_ptr), bam_header(BAM_header) {}
<a name="l00074"></a><a class="code" href="class_b_a_m_read.html#a88ae0799815e3e930e773a5717aad0fb">00074</a>  <a class="code" href="class_b_a_m_read.html#a88ae0799815e3e930e773a5717aad0fb">~BAMRead</a>() { bam_record.reset(); }
<a name="l00075"></a>00075  
<a name="l00080"></a><a class="code" href="class_b_a_m_read.html#ac07560ff3a2d6c645774e72605e85439">00080</a>  <a class="code" href="class_b_a_m_read.html#ac07560ff3a2d6c645774e72605e85439">BAMRead</a>(<a class="code" href="class_b_a_m_read.html">BAMRead</a> <span class="keyword">const</span>&amp; other) : bam_record(other.bam_record), bam_header(other.bam_header) {}
<a name="l00081"></a>00081 
<a name="l00082"></a>00082  
<a name="l00083"></a>00083  
<a name="l00088"></a><a class="code" href="class_b_a_m_read.html#a6d1e8f2f083126575ef2fb3ae0662af9">00088</a>  <a class="code" href="class_b_a_m_read.html">BAMRead</a>&amp; <a class="code" href="class_b_a_m_read.html#a6d1e8f2f083126575ef2fb3ae0662af9">operator=</a>(<a class="code" href="class_b_a_m_read.html">BAMRead</a> that) {
<a name="l00089"></a>00089    
<a name="l00090"></a>00090   swap(*<span class="keyword">this</span>, that);
<a name="l00091"></a>00091   <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00092"></a>00092   
<a name="l00093"></a>00093  }
<a name="l00094"></a>00094  
<a name="l00098"></a>00098  bam1_t* get_bam_ptr()<span class="keyword"> const </span>{ 
<a name="l00099"></a>00099   <span class="keywordflow">return</span> bam_record.get(); 
<a name="l00100"></a>00100  }
<a name="l00101"></a>00101  
<a name="l00102"></a>00102   
<a name="l00103"></a>00103 
<a name="l00110"></a>00110   str_ptr      get_qname( ) <span class="keyword">const</span>;
<a name="l00129"></a>00129   uint32_t     get_flag() <span class="keyword">const</span>;
<a name="l00139"></a>00139   str_ptr      get_rname();
<a name="l00147"></a>00147   coord_t      get_pos() <span class="keyword">const</span>;
<a name="l00154"></a>00154   <span class="keywordtype">int</span>       get_mapq() <span class="keyword">const</span>;
<a name="l00161"></a>00161   <a class="code" href="class_cigar.html">Cigar</a>      get_cigar();
<a name="l00176"></a>00176   str_ptr      get_rnext();
<a name="l00185"></a>00185   coord_t      get_pnext() <span class="keyword">const</span>;
<a name="l00195"></a>00195   coord_t      get_tlen() <span class="keyword">const</span>;
<a name="l00204"></a>00204   <a class="code" href="class_sequence.html">Sequence</a>     get_seq();
<a name="l00213"></a>00213   <a class="code" href="class_qual.html">Qual</a>      get_qual();
<a name="l00214"></a>00214   <span class="comment">//str_ptr      get_mrnm();</span>
<a name="l00215"></a>00215   <span class="comment">//coord_t      get_mpos() const;</span>
<a name="l00216"></a>00216   
<a name="l00222"></a>00222   <span class="keywordtype">int</span>       get_tid() <span class="keyword">const</span>;
<a name="l00223"></a>00223   
<a name="l00224"></a>00224   <span class="comment">//optional tags</span>
<a name="l00230"></a><a class="code" href="class_b_a_m_read.html#a358fbd29d88ad606659cac981102e03a">00230</a> <span class="comment"></span>  <span class="keyword">inline</span> str_ptr      <a class="code" href="class_b_a_m_read.html#a358fbd29d88ad606659cac981102e03a">get_xa</a>()<span class="keyword"> const </span>{
<a name="l00231"></a>00231    assert(bam_record);
<a name="l00232"></a>00232    uint8_t* xa = bam_aux_get(bam_record.get(), <span class="stringliteral">&quot;XA&quot;</span>);
<a name="l00233"></a>00233    <span class="keywordflow">if</span> (xa) {
<a name="l00234"></a>00234     <span class="keywordflow">return</span> bam_aux2Z(xa);
<a name="l00235"></a>00235    } <span class="keywordflow">else</span> {
<a name="l00236"></a>00236     <span class="keywordflow">return</span> NULL;
<a name="l00237"></a>00237    }
<a name="l00238"></a>00238    
<a name="l00239"></a>00239    
<a name="l00240"></a>00240   }
<a name="l00241"></a>00241   
<a name="l00248"></a><a class="code" href="class_b_a_m_read.html#ad0a0a8ccc29cd8329056e006e75d32be">00248</a>   <span class="keyword">inline</span> coord_t      <a class="code" href="class_b_a_m_read.html#ad0a0a8ccc29cd8329056e006e75d32be">get_xs</a>()<span class="keyword"> const </span>{
<a name="l00249"></a>00249    uint8_t *xs = bam_aux_get(bam_record.get(), <span class="stringliteral">&quot;XS&quot;</span>);
<a name="l00250"></a>00250    <span class="keywordflow">if</span> (xs != NULL) {
<a name="l00251"></a>00251     <span class="keywordflow">return</span> bam_aux2i(xs);
<a name="l00252"></a>00252    } <span class="keywordflow">else</span> {
<a name="l00253"></a>00253     <span class="keywordflow">return</span> -1; 
<a name="l00254"></a>00254    }
<a name="l00255"></a>00255    
<a name="l00256"></a>00256   }
<a name="l00262"></a><a class="code" href="class_b_a_m_read.html#a98e60253d0a82bc31c39ce73404f31d3">00262</a>   <span class="keyword">inline</span> coord_t      <a class="code" href="class_b_a_m_read.html#a98e60253d0a82bc31c39ce73404f31d3">get_xt</a>()<span class="keyword"> const</span>{
<a name="l00263"></a>00263    uint8_t *xt = bam_aux_get(bam_record.get(), <span class="stringliteral">&quot;XT&quot;</span>);
<a name="l00264"></a>00264    <span class="keywordflow">if</span> (xt != NULL) {
<a name="l00265"></a>00265     <span class="keywordflow">return</span> bam_aux2i(xt);
<a name="l00266"></a>00266    } <span class="keywordflow">else</span> {
<a name="l00267"></a>00267     <span class="keywordflow">return</span> -1; 
<a name="l00268"></a>00268    }
<a name="l00269"></a>00269    
<a name="l00270"></a>00270   }
<a name="l00271"></a>00271  
<a name="l00272"></a>00272  
<a name="l00273"></a>00273   
<a name="l00279"></a>00279   <span class="keywordtype">int</span>       get_as();
<a name="l00285"></a>00285   <span class="keywordtype">int</span>       get_hi();
<a name="l00291"></a>00291   <span class="keywordtype">int</span>       get_ih();
<a name="l00297"></a>00297   str_ptr      get_pg();
<a name="l00303"></a>00303   <span class="keywordtype">int</span>       get_sm();
<a name="l00309"></a>00309   str_ptr      get_rg();
<a name="l00316"></a>00316   <span class="keywordtype">int</span>      get_nm();
<a name="l00322"></a>00322   <span class="keywordtype">int</span>      get_nh(); 
<a name="l00323"></a>00323  
<a name="l00334"></a>00334   <a class="code" href="class_m_d.html">MD</a>       get_md(); 
<a name="l00335"></a>00335   
<a name="l00336"></a>00336  
<a name="l00337"></a>00337  
<a name="l00338"></a>00338  
<a name="l00339"></a>00339   <span class="comment">//utilities</span>
<a name="l00344"></a>00344 <span class="comment"></span>  <span class="keywordtype">bool</span>      is_mapped() <span class="keyword">const</span>;
<a name="l00350"></a>00350   <span class="keywordtype">bool</span>      is_mapped_unique() ;
<a name="l00356"></a>00356   <span class="keywordtype">bool</span>      is_paired() <span class="keyword">const</span>;
<a name="l00363"></a>00363   <span class="keywordtype">bool</span>      proper_pair() <span class="keyword">const</span>;
<a name="l00369"></a>00369   <span class="keywordtype">bool</span>      mapped_reverse_strand() <span class="keyword">const</span>;
<a name="l00375"></a>00375   <span class="keywordtype">bool</span>      mate_mapped_reverse_strand() <span class="keyword">const</span>;
<a name="l00381"></a>00381   <span class="keywordtype">bool</span>      is_read1() <span class="keyword">const</span>;
<a name="l00387"></a>00387   <span class="keywordtype">bool</span>      is_read2() <span class="keyword">const</span>;
<a name="l00393"></a>00393   <span class="keywordtype">bool</span>      is_primary() <span class="keyword">const</span>;
<a name="l00399"></a>00399   <span class="keywordtype">bool</span>      is_duplicate() <span class="keyword">const</span>;
<a name="l00405"></a>00405   coord_t      get_ref_len();
<a name="l00412"></a>00412   <span class="keywordtype">int</span>       calend() <span class="keyword">const</span>;
<a name="l00413"></a>00413  
<a name="l00419"></a>00419   std::string      to_string();
<a name="l00420"></a>00420   
<a name="l00421"></a>00421  
<a name="l00422"></a>00422   
<a name="l00423"></a>00423  
<a name="l00424"></a>00424  <span class="keyword">private</span>:
<a name="l00425"></a>00425   <span class="keywordtype">void</span> swap(<a class="code" href="class_b_a_m_read.html">BAMRead</a>&amp; first, <a class="code" href="class_b_a_m_read.html">BAMRead</a>&amp; second) {
<a name="l00426"></a>00426    <span class="keyword">using</span> std::swap; <span class="comment">//enables ADL</span>
<a name="l00427"></a>00427    swap(first.bam_record, second.bam_record);
<a name="l00428"></a>00428    swap(first.bam_header, second.bam_header);
<a name="l00429"></a>00429   }
<a name="l00430"></a>00430   bam_ptr    bam_record;
<a name="l00431"></a>00431   <span class="keyword">const</span> bam_header_t*   bam_header;
<a name="l00432"></a>00432   
<a name="l00433"></a>00433  
<a name="l00434"></a>00434  <span class="keywordtype">void</span> get_optional_field(std::string&amp; tag, <span class="keywordtype">int</span>&amp; opt_int) {
<a name="l00435"></a>00435   
<a name="l00436"></a>00436   uint8_t *opt_ptr = bam_aux_get(bam_record.get(), tag.c_str());
<a name="l00437"></a>00437   <span class="keywordflow">if</span> (opt_ptr) {
<a name="l00438"></a>00438    opt_int = bam_aux2i(opt_ptr);
<a name="l00439"></a>00439   }  <span class="keywordflow">else</span> {
<a name="l00440"></a>00440    opt_int = -1;
<a name="l00441"></a>00441   }
<a name="l00442"></a>00442 
<a name="l00443"></a>00443   
<a name="l00444"></a>00444  }
<a name="l00445"></a>00445  
<a name="l00446"></a>00446  str_ptr  get_optional_field(std::string&amp; tag){
<a name="l00447"></a>00447   
<a name="l00448"></a>00448   
<a name="l00449"></a>00449   uint8_t *opt_ptr = bam_aux_get(bam_record.get(), tag.c_str());
<a name="l00450"></a>00450   str_ptr opt_str = NULL;
<a name="l00451"></a>00451   <span class="keywordflow">if</span> (opt_ptr) {
<a name="l00452"></a>00452    opt_str = bam_aux2Z(opt_ptr);
<a name="l00453"></a>00453   } 
<a name="l00454"></a>00454   <span class="keywordflow">return</span> opt_str;
<a name="l00455"></a>00455   
<a name="l00456"></a>00456  }
<a name="l00457"></a>00457 
<a name="l00458"></a>00458  
<a name="l00459"></a>00459 
<a name="l00460"></a>00460   <span class="comment">//utility functions</span>
<a name="l00461"></a>00461  <span class="keywordtype">void</span>   _init();
<a name="l00462"></a>00462  std::string  to_string_1_2();
<a name="l00463"></a>00463  std::string  to_string_1_3();
<a name="l00464"></a>00464  
<a name="l00465"></a>00465 };
<a name="l00466"></a>00466 
<a name="l00467"></a><a class="code" href="class_b_a_m_read.html#a6d9d5003de72a18427480e2ffcbd75fc">00467</a> <span class="keyword">inline</span> str_ptr <a class="code" href="class_b_a_m_read.html#a6d9d5003de72a18427480e2ffcbd75fc">BAMRead::get_qname</a>()<span class="keyword"> const  </span>{
<a name="l00468"></a>00468  <span class="keywordflow">return</span> bam1_qname(bam_record);
<a name="l00469"></a>00469  <span class="comment">// return qname;</span>
<a name="l00470"></a>00470  
<a name="l00471"></a>00471 }
<a name="l00472"></a>00472 <span class="keyword">inline</span> 
<a name="l00473"></a><a class="code" href="class_b_a_m_read.html#a6a6794d5f7cd8f42b00cc933ea0c8f15">00473</a> uint32_t <a class="code" href="class_b_a_m_read.html#a6a6794d5f7cd8f42b00cc933ea0c8f15">BAMRead::get_flag</a>()<span class="keyword"> const </span>{
<a name="l00474"></a>00474  <span class="keywordflow">if</span> (bam_record != NULL) {
<a name="l00475"></a>00475   <span class="keywordflow">return</span> bam_record-&gt;core.flag;
<a name="l00476"></a>00476   
<a name="l00477"></a>00477  } <span class="keywordflow">else</span> {
<a name="l00478"></a>00478   <span class="keywordflow">return</span> -1; <span class="comment">//failed</span>
<a name="l00479"></a>00479  }
<a name="l00480"></a>00480  
<a name="l00481"></a>00481  
<a name="l00482"></a>00482 }
<a name="l00483"></a>00483 
<a name="l00484"></a>00484 <span class="keyword">inline</span>
<a name="l00485"></a><a class="code" href="class_b_a_m_read.html#abfa160a0de8d874f5209e39efd796eac">00485</a> str_ptr  <a class="code" href="class_b_a_m_read.html#abfa160a0de8d874f5209e39efd796eac">BAMRead::get_rname</a>()  {
<a name="l00486"></a>00486  assert(bam_record);
<a name="l00487"></a>00487  
<a name="l00488"></a>00488  int32_t tid = bam_record-&gt;core.tid; 
<a name="l00489"></a>00489  <span class="keywordflow">if</span> (tid == -1) {
<a name="l00490"></a>00490   <span class="keywordflow">return</span> 0; <span class="comment">//null value</span>
<a name="l00491"></a>00491  } <span class="keywordflow">else</span> {
<a name="l00492"></a>00492   <span class="comment">//bam_header_t* bht = itr_file-&gt;header;</span>
<a name="l00493"></a>00493   <span class="keywordflow">return</span> bam_header-&gt;target_name[tid];
<a name="l00494"></a>00494   
<a name="l00495"></a>00495  }
<a name="l00496"></a>00496  
<a name="l00497"></a>00497  
<a name="l00498"></a>00498 }
<a name="l00499"></a>00499 
<a name="l00500"></a>00500 
<a name="l00501"></a>00501 <span class="keyword">inline</span>
<a name="l00502"></a><a class="code" href="class_b_a_m_read.html#a612a3a20a299d8ecb8fc4d9b87a3d5ac">00502</a> coord_t <a class="code" href="class_b_a_m_read.html#a612a3a20a299d8ecb8fc4d9b87a3d5ac">BAMRead::get_ref_len</a>() {
<a name="l00503"></a>00503  assert(bam_record);
<a name="l00504"></a>00504  int32_t tid = bam_record-&gt;core.tid;
<a name="l00505"></a>00505  <span class="keywordflow">if</span> (tid == -1) {
<a name="l00506"></a>00506   <span class="keywordflow">return</span> 0;
<a name="l00507"></a>00507  } <span class="keywordflow">else</span> {
<a name="l00508"></a>00508   <span class="keywordflow">return</span> bam_header-&gt;target_len[tid];
<a name="l00509"></a>00509  }
<a name="l00510"></a>00510  
<a name="l00511"></a>00511  
<a name="l00512"></a>00512 }
<a name="l00513"></a>00513 
<a name="l00514"></a>00514 <span class="keyword">inline</span>
<a name="l00515"></a><a class="code" href="class_b_a_m_read.html#a04421480527f25f49e0cec5ad248cf4f">00515</a> <span class="keywordtype">int</span> <a class="code" href="class_b_a_m_read.html#a04421480527f25f49e0cec5ad248cf4f">BAMRead::get_tid</a>()<span class="keyword"> const </span>{
<a name="l00516"></a>00516  assert(bam_record);
<a name="l00517"></a>00517  <span class="keywordflow">return</span> bam_record-&gt;core.tid;
<a name="l00518"></a>00518 }
<a name="l00519"></a>00519 
<a name="l00520"></a>00520 <span class="keyword">inline</span>
<a name="l00521"></a><a class="code" href="class_b_a_m_read.html#ad0eabedce37189ad45ba29eadbee550a">00521</a> coord_t <a class="code" href="class_b_a_m_read.html#ad0eabedce37189ad45ba29eadbee550a">BAMRead::get_pos</a>()<span class="keyword">   const </span>{
<a name="l00522"></a>00522  <span class="keywordflow">return</span> bam_record-&gt;core.pos + 1; <span class="comment">//1 based</span>
<a name="l00523"></a>00523 }
<a name="l00524"></a>00524 
<a name="l00525"></a>00525 
<a name="l00526"></a>00526 <span class="keyword">inline</span>
<a name="l00527"></a><a class="code" href="class_b_a_m_read.html#a6e53eeaa3db0034c9094402c89730b28">00527</a> <span class="keywordtype">int</span> <a class="code" href="class_b_a_m_read.html#a6e53eeaa3db0034c9094402c89730b28">BAMRead::get_mapq</a>()<span class="keyword">  const </span>{
<a name="l00528"></a>00528  <span class="keywordflow">if</span> (bam_record == NULL) {
<a name="l00529"></a>00529   <span class="keywordflow">return</span> -1; 
<a name="l00530"></a>00530  } <span class="keywordflow">else</span> {
<a name="l00531"></a>00531   <span class="keywordtype">int</span> ret = bam_record-&gt;core.qual;
<a name="l00532"></a>00532   <span class="keywordflow">if</span> (ret &gt; 0) {
<a name="l00533"></a>00533    <span class="keywordflow">return</span> ret;
<a name="l00534"></a>00534   } <span class="keywordflow">else</span> {
<a name="l00535"></a>00535    <span class="keywordflow">return</span> 0;
<a name="l00536"></a>00536   }
<a name="l00537"></a>00537   
<a name="l00538"></a>00538  }
<a name="l00539"></a>00539 }
<a name="l00540"></a>00540 
<a name="l00541"></a>00541 <span class="keyword">inline</span>
<a name="l00542"></a><a class="code" href="class_b_a_m_read.html#a0281ad0d64a15d874314ffe15c98c615">00542</a> coord_t <a class="code" href="class_b_a_m_read.html#a0281ad0d64a15d874314ffe15c98c615">BAMRead::get_pnext</a>()<span class="keyword"> const </span>{ 
<a name="l00543"></a>00543  assert(bam_record);
<a name="l00544"></a>00544  <span class="keywordflow">if</span> (bam_record-&gt;core.mpos == -1) {
<a name="l00545"></a>00545   <span class="keywordflow">return</span> 0;
<a name="l00546"></a>00546  } <span class="keywordflow">else</span> {
<a name="l00547"></a>00547   <span class="keywordflow">return</span> bam_record-&gt;core.mpos;
<a name="l00548"></a>00548  } 
<a name="l00549"></a>00549  
<a name="l00550"></a>00550 }
<a name="l00551"></a>00551 
<a name="l00552"></a>00552 
<a name="l00553"></a>00553 <span class="keyword">inline</span>
<a name="l00554"></a><a class="code" href="class_b_a_m_read.html#a773f27591a8141752326458aa5942352">00554</a> coord_t <a class="code" href="class_b_a_m_read.html#a773f27591a8141752326458aa5942352">BAMRead::get_tlen</a>()<span class="keyword"> const </span>{
<a name="l00555"></a>00555  int32_t tln = bam_record-&gt;core.l_qseq;
<a name="l00556"></a>00556  
<a name="l00557"></a>00557  <span class="keywordflow">return</span> tln;
<a name="l00558"></a>00558 }
<a name="l00559"></a>00559 
<a name="l00560"></a>00560 <span class="comment">/*** optional tags ***</span>
<a name="l00561"></a>00561 <span class="comment"> -have to implement MD at very least</span>
<a name="l00562"></a>00562 <span class="comment"> */</span>
<a name="l00563"></a>00563 
<a name="l00564"></a>00564 <span class="keyword">inline</span>
<a name="l00565"></a><a class="code" href="class_b_a_m_read.html#a3db15b68f63c8e263a9b08874404f522">00565</a> str_ptr <a class="code" href="class_b_a_m_read.html#a3db15b68f63c8e263a9b08874404f522">BAMRead::get_pg</a>()  {
<a name="l00566"></a>00566  
<a name="l00567"></a>00567  assert(bam_record);
<a name="l00568"></a>00568  str_ptr pg;
<a name="l00569"></a>00569  std::string tag(<span class="stringliteral">&quot;PG&quot;</span>);
<a name="l00570"></a>00570  pg = get_optional_field(tag);
<a name="l00571"></a>00571  
<a name="l00572"></a>00572  <span class="comment">/*</span>
<a name="l00573"></a>00573 <span class="comment"> uint8_t *pg_ptr = bam_aux_get(bam_record.get(), &quot;PG&quot;);</span>
<a name="l00574"></a>00574 <span class="comment"> </span>
<a name="l00575"></a>00575 <span class="comment"> if (pg_ptr) {</span>
<a name="l00576"></a>00576 <span class="comment">  pg = bam_aux2Z(pg_ptr);</span>
<a name="l00577"></a>00577 <span class="comment"> } */</span>
<a name="l00578"></a>00578  <span class="keywordflow">return</span> pg;
<a name="l00579"></a>00579  
<a name="l00580"></a>00580 }
<a name="l00581"></a>00581 
<a name="l00582"></a>00582 <span class="keyword">inline</span>
<a name="l00583"></a><a class="code" href="class_b_a_m_read.html#a040e66330ed38e9ac2a5080029ce522f">00583</a> <span class="keywordtype">int</span> <a class="code" href="class_b_a_m_read.html#a040e66330ed38e9ac2a5080029ce522f">BAMRead::get_ih</a>()  {
<a name="l00584"></a>00584  assert(bam_record);
<a name="l00585"></a>00585  <span class="keywordtype">int</span> ih = -1;
<a name="l00586"></a>00586  std::string tag(<span class="stringliteral">&quot;IH&quot;</span>);
<a name="l00587"></a>00587  get_optional_field(tag, ih);
<a name="l00588"></a>00588  <span class="keywordflow">return</span> ih;
<a name="l00589"></a>00589  <span class="comment">/*</span>
<a name="l00590"></a>00590 <span class="comment"> uint8_t* ih = bam_aux_get(bam_record.get(), &quot;IH&quot;);</span>
<a name="l00591"></a>00591 <span class="comment"> if (ih) {</span>
<a name="l00592"></a>00592 <span class="comment">  return bam_aux2i(ih);</span>
<a name="l00593"></a>00593 <span class="comment"> } else {</span>
<a name="l00594"></a>00594 <span class="comment">  return -1;</span>
<a name="l00595"></a>00595 <span class="comment"> }*/</span>
<a name="l00596"></a>00596  
<a name="l00597"></a>00597  
<a name="l00598"></a>00598 }
<a name="l00599"></a>00599 <span class="keyword">inline</span>
<a name="l00600"></a><a class="code" href="class_b_a_m_read.html#aaa3950f12efb6682676829ea61b59d6d">00600</a> <span class="keywordtype">int</span> <a class="code" href="class_b_a_m_read.html#aaa3950f12efb6682676829ea61b59d6d">BAMRead::get_hi</a>()  {
<a name="l00601"></a>00601  assert(bam_record);
<a name="l00602"></a>00602  
<a name="l00603"></a>00603  <span class="keywordtype">int</span> hi = -1;
<a name="l00604"></a>00604  std::string tag(<span class="stringliteral">&quot;HI&quot;</span>);
<a name="l00605"></a>00605  get_optional_field(tag, hi);
<a name="l00606"></a>00606  <span class="keywordflow">return</span> hi;
<a name="l00607"></a>00607  <span class="comment">/*</span>
<a name="l00608"></a>00608 <span class="comment"> uint8_t* hi = bam_aux_get(bam_record.get(), &quot;HI&quot;);</span>
<a name="l00609"></a>00609 <span class="comment"> if (hi) {</span>
<a name="l00610"></a>00610 <span class="comment">  return bam_aux2i(hi);</span>
<a name="l00611"></a>00611 <span class="comment"> } else {</span>
<a name="l00612"></a>00612 <span class="comment">  return -1;</span>
<a name="l00613"></a>00613 <span class="comment"> }*/</span>
<a name="l00614"></a>00614  
<a name="l00615"></a>00615  
<a name="l00616"></a>00616  
<a name="l00617"></a>00617 }
<a name="l00618"></a>00618 
<a name="l00619"></a>00619 
<a name="l00620"></a>00620 <span class="keyword">inline</span>
<a name="l00621"></a><a class="code" href="class_b_a_m_read.html#af8aa1684299833e57837b4fde4298ea9">00621</a> <span class="keywordtype">int</span> <a class="code" href="class_b_a_m_read.html#af8aa1684299833e57837b4fde4298ea9">BAMRead::get_sm</a>()  {
<a name="l00622"></a>00622  
<a name="l00623"></a>00623  assert(bam_record);
<a name="l00624"></a>00624  <span class="keywordtype">int</span> sm = -1;
<a name="l00625"></a>00625  std::string tag(<span class="stringliteral">&quot;SM&quot;</span>);
<a name="l00626"></a>00626  get_optional_field(tag, sm);
<a name="l00627"></a>00627  <span class="keywordflow">return</span> sm;
<a name="l00628"></a>00628  
<a name="l00629"></a>00629  <span class="comment">/*</span>
<a name="l00630"></a>00630 <span class="comment"> uint8_t *sm = bam_aux_get(bam_record.get(), &quot;SM&quot;);</span>
<a name="l00631"></a>00631 <span class="comment"> if (sm != NULL) {</span>
<a name="l00632"></a>00632 <span class="comment">  return bam_aux2i(sm);</span>
<a name="l00633"></a>00633 <span class="comment"> } else {</span>
<a name="l00634"></a>00634 <span class="comment">  return -1; </span>
<a name="l00635"></a>00635 <span class="comment"> }*/</span>
<a name="l00636"></a>00636 }
<a name="l00637"></a>00637 <span class="keyword">inline</span>
<a name="l00638"></a><a class="code" href="class_b_a_m_read.html#ac8b4d5ec304d8fa8c75dcac71e38759f">00638</a> str_ptr <a class="code" href="class_b_a_m_read.html#ac8b4d5ec304d8fa8c75dcac71e38759f">BAMRead::get_rg</a>()  {
<a name="l00639"></a>00639  assert(bam_record);
<a name="l00640"></a>00640  str_ptr rg;
<a name="l00641"></a>00641  std::string tag(<span class="stringliteral">&quot;RG&quot;</span>);
<a name="l00642"></a>00642  rg = get_optional_field(tag);
<a name="l00643"></a>00643  <span class="comment">/*</span>
<a name="l00644"></a>00644 <span class="comment"> uint8_t *rg_ptr = bam_aux_get(bam_record.get(), &quot;RG&quot;);</span>
<a name="l00645"></a>00645 <span class="comment"> str_ptr rg;</span>
<a name="l00646"></a>00646 <span class="comment"> if (rg_ptr) {</span>
<a name="l00647"></a>00647 <span class="comment">  rg = bam_aux2Z(rg_ptr);</span>
<a name="l00648"></a>00648 <span class="comment"> } */</span>
<a name="l00649"></a>00649  
<a name="l00650"></a>00650  <span class="keywordflow">return</span> rg;
<a name="l00651"></a>00651 }
<a name="l00652"></a>00652 
<a name="l00653"></a>00653 
<a name="l00654"></a>00654 <span class="keyword">inline</span>
<a name="l00655"></a><a class="code" href="class_b_a_m_read.html#a551b6a6a5c2946c8a29fa4c1ebbfab02">00655</a> <span class="keywordtype">int</span> <a class="code" href="class_b_a_m_read.html#a551b6a6a5c2946c8a29fa4c1ebbfab02">BAMRead::get_nm</a>()  {
<a name="l00656"></a>00656  assert(bam_record);
<a name="l00657"></a>00657  <span class="keywordtype">int</span> nm = -1;
<a name="l00658"></a>00658  std::string tag(<span class="stringliteral">&quot;NM&quot;</span>);
<a name="l00659"></a>00659  get_optional_field(tag, nm);
<a name="l00660"></a>00660  <span class="keywordflow">return</span> nm;
<a name="l00661"></a>00661  <span class="comment">/*</span>
<a name="l00662"></a>00662 <span class="comment"> uint8_t *nm = bam_aux_get(bam_record.get(), &quot;NM&quot;);</span>
<a name="l00663"></a>00663 <span class="comment"> if (nm) {</span>
<a name="l00664"></a>00664 <span class="comment">  return bam_aux2i(nm);</span>
<a name="l00665"></a>00665 <span class="comment"> } else{</span>
<a name="l00666"></a>00666 <span class="comment">  return -1;</span>
<a name="l00667"></a>00667 <span class="comment"> }*/</span>
<a name="l00668"></a>00668 }
<a name="l00669"></a>00669 
<a name="l00670"></a>00670 <span class="keyword">inline</span>
<a name="l00671"></a><a class="code" href="class_b_a_m_read.html#aa54edc07ecf6aff07a1475a993776338">00671</a> <span class="keywordtype">int</span> <a class="code" href="class_b_a_m_read.html#aa54edc07ecf6aff07a1475a993776338">BAMRead::get_nh</a>()  {
<a name="l00672"></a>00672  assert(bam_record);
<a name="l00673"></a>00673  <span class="keywordtype">int</span> nh = -1;
<a name="l00674"></a>00674  std::string tag(<span class="stringliteral">&quot;NH&quot;</span>);
<a name="l00675"></a>00675  get_optional_field(tag, nh);
<a name="l00676"></a>00676  <span class="keywordflow">return</span> nh;
<a name="l00677"></a>00677  <span class="comment">/*</span>
<a name="l00678"></a>00678 <span class="comment"> uint8_t* nh = bam_aux_get(bam_record.get(), &quot;NH&quot;);</span>
<a name="l00679"></a>00679 <span class="comment"> if (nh) {</span>
<a name="l00680"></a>00680 <span class="comment">  return bam_aux2i(nh);</span>
<a name="l00681"></a>00681 <span class="comment"> } else {</span>
<a name="l00682"></a>00682 <span class="comment">  return -1;</span>
<a name="l00683"></a>00683 <span class="comment"> }*/</span>
<a name="l00684"></a>00684  
<a name="l00685"></a>00685 }
<a name="l00686"></a>00686 
<a name="l00687"></a>00687 <span class="keyword">inline</span> 
<a name="l00688"></a><a class="code" href="class_b_a_m_read.html#aa713b4e990bd25a99cb6cb6ccaba7ac8">00688</a> <span class="keywordtype">int</span> <a class="code" href="class_b_a_m_read.html#aa713b4e990bd25a99cb6cb6ccaba7ac8">BAMRead::get_as</a>() {
<a name="l00689"></a>00689  assert(bam_record);
<a name="l00690"></a>00690  uint8_t *pg = bam_aux_get(bam_record.get(), <span class="stringliteral">&quot;AS&quot;</span>);
<a name="l00691"></a>00691  <span class="keywordflow">if</span> (pg) {
<a name="l00692"></a>00692   <span class="comment">// caveat this is a kludge have to talk to nils</span>
<a name="l00693"></a>00693   int32_t ret = bam_aux2i(pg);
<a name="l00694"></a>00694   <span class="comment">//&quot;-2147483648&quot;</span>
<a name="l00695"></a>00695   <span class="keywordflow">if</span> (ret == -2147483648) {
<a name="l00696"></a>00696    <span class="keywordflow">return</span> ret;
<a name="l00697"></a>00697   } <span class="keywordflow">else</span> {
<a name="l00698"></a>00698    <span class="keywordflow">return</span> ret;
<a name="l00699"></a>00699   }
<a name="l00700"></a>00700   
<a name="l00701"></a>00701  } <span class="keywordflow">else</span> {
<a name="l00702"></a>00702   <span class="keywordflow">return</span> -1;
<a name="l00703"></a>00703  }
<a name="l00704"></a>00704  
<a name="l00705"></a>00705  
<a name="l00706"></a>00706 }
<a name="l00707"></a>00707 
<a name="l00708"></a>00708 <span class="keyword">inline</span>
<a name="l00709"></a><a class="code" href="class_b_a_m_read.html#a58f99aed61006fb9b4a4a3115382ca18">00709</a> <a class="code" href="class_m_d.html">MD</a> <a class="code" href="class_b_a_m_read.html#a58f99aed61006fb9b4a4a3115382ca18">BAMRead::get_md</a>()  {
<a name="l00710"></a>00710  assert(bam_record);
<a name="l00711"></a>00711  
<a name="l00712"></a>00712  <span class="keywordflow">return</span> <a class="code" href="class_m_d.html">MD</a>(bam_record.get());
<a name="l00713"></a>00713  
<a name="l00714"></a>00714  
<a name="l00715"></a>00715  
<a name="l00716"></a>00716 }
<a name="l00717"></a>00717 
<a name="l00718"></a>00718 <span class="comment">/* utils */</span>
<a name="l00719"></a>00719 <span class="keyword">inline</span>
<a name="l00720"></a><a class="code" href="class_b_a_m_read.html#ac6e68fb8c75b6f722024a81ab5866d92">00720</a> <span class="keywordtype">bool</span> <a class="code" href="class_b_a_m_read.html#ac6e68fb8c75b6f722024a81ab5866d92">BAMRead::is_mapped</a>()<span class="keyword"> const </span>{
<a name="l00721"></a>00721  
<a name="l00722"></a>00722  <span class="comment">//return (nh() &gt; 0);</span>
<a name="l00723"></a>00723  assert(bam_record);
<a name="l00724"></a>00724  <span class="keywordflow">return</span> !(BAM_FUNMAP &amp; bam_record-&gt;core.flag);
<a name="l00725"></a>00725  
<a name="l00726"></a>00726 }
<a name="l00727"></a>00727 <span class="keyword">inline</span>
<a name="l00728"></a><a class="code" href="class_b_a_m_read.html#abee0c3fd935865fb8bde955931a66d80">00728</a> <span class="keywordtype">bool</span> <a class="code" href="class_b_a_m_read.html#abee0c3fd935865fb8bde955931a66d80">BAMRead::is_mapped_unique</a>()  {
<a name="l00729"></a>00729  
<a name="l00730"></a>00730  <span class="keywordflow">return</span>(get_nh() == 1);
<a name="l00731"></a>00731 }
<a name="l00732"></a>00732 
<a name="l00733"></a>00733 <span class="keyword">inline</span>
<a name="l00734"></a><a class="code" href="class_b_a_m_read.html#ac42757573fe5d30cc8725124fd28fd2b">00734</a> <span class="keywordtype">bool</span> <a class="code" href="class_b_a_m_read.html#ac42757573fe5d30cc8725124fd28fd2b">BAMRead::is_paired</a>()<span class="keyword"> const </span>{
<a name="l00735"></a>00735  assert(bam_record);
<a name="l00736"></a>00736  <span class="keywordflow">return</span> BAM_FPAIRED &amp; bam_record-&gt;core.flag;
<a name="l00737"></a>00737  
<a name="l00738"></a>00738 }
<a name="l00739"></a>00739 <span class="keyword">inline</span>
<a name="l00740"></a><a class="code" href="class_b_a_m_read.html#a12218736728585c3ad8e22be41e63b8a">00740</a> <span class="keywordtype">bool</span> <a class="code" href="class_b_a_m_read.html#a12218736728585c3ad8e22be41e63b8a">BAMRead::proper_pair</a>()<span class="keyword"> const </span>{
<a name="l00741"></a>00741  assert(bam_record);
<a name="l00742"></a>00742  <span class="keywordflow">return</span> BAM_FPROPER_PAIR &amp; bam_record-&gt;core.flag;
<a name="l00743"></a>00743  
<a name="l00744"></a>00744  
<a name="l00745"></a>00745 }
<a name="l00746"></a>00746 <span class="keyword">inline</span>
<a name="l00747"></a><a class="code" href="class_b_a_m_read.html#a2bf6db37d6f73fdd6cf1ef233efa46d0">00747</a> <span class="keywordtype">bool</span> <a class="code" href="class_b_a_m_read.html#a2bf6db37d6f73fdd6cf1ef233efa46d0">BAMRead::mapped_reverse_strand</a>()<span class="keyword"> const </span>{
<a name="l00748"></a>00748  assert(bam_record);
<a name="l00749"></a>00749  <span class="keywordflow">return</span> BAM_FREVERSE &amp; bam_record-&gt;core.flag;
<a name="l00750"></a>00750  
<a name="l00751"></a>00751 }
<a name="l00752"></a>00752 <span class="keyword">inline</span>
<a name="l00753"></a><a class="code" href="class_b_a_m_read.html#adbc2990ced7211feb13c382eb9d0ae93">00753</a> <span class="keywordtype">bool</span> <a class="code" href="class_b_a_m_read.html#adbc2990ced7211feb13c382eb9d0ae93">BAMRead::mate_mapped_reverse_strand</a>()<span class="keyword"> const </span>{
<a name="l00754"></a>00754  assert(bam_record);
<a name="l00755"></a>00755  <span class="keywordflow">return</span> BAM_FMREVERSE &amp; bam_record-&gt;core.flag;
<a name="l00756"></a>00756  
<a name="l00757"></a>00757 }
<a name="l00758"></a>00758 <span class="keyword">inline</span>
<a name="l00759"></a><a class="code" href="class_b_a_m_read.html#aaf25681f4fc846f4718cbc440d6a038a">00759</a> <span class="keywordtype">bool</span> <a class="code" href="class_b_a_m_read.html#aaf25681f4fc846f4718cbc440d6a038a">BAMRead::is_read1</a>()<span class="keyword"> const </span>{
<a name="l00760"></a>00760  
<a name="l00761"></a>00761  assert(bam_record);
<a name="l00762"></a>00762  <span class="keywordflow">return</span> BAM_FREAD1 &amp; bam_record-&gt;core.flag;
<a name="l00763"></a>00763  
<a name="l00764"></a>00764 }
<a name="l00765"></a>00765 <span class="keyword">inline</span>
<a name="l00766"></a><a class="code" href="class_b_a_m_read.html#a7b0214dc321ad06f766d5bbde98e38d5">00766</a> <span class="keywordtype">bool</span> <a class="code" href="class_b_a_m_read.html#a7b0214dc321ad06f766d5bbde98e38d5">BAMRead::is_read2</a>()<span class="keyword"> const </span>{
<a name="l00767"></a>00767  assert(bam_record);
<a name="l00768"></a>00768  <span class="keywordflow">return</span> BAM_FREAD2 &amp; bam_record-&gt;core.flag;
<a name="l00769"></a>00769  
<a name="l00770"></a>00770  
<a name="l00771"></a>00771  
<a name="l00772"></a>00772 }
<a name="l00773"></a>00773 <span class="keyword">inline</span>
<a name="l00774"></a><a class="code" href="class_b_a_m_read.html#a77171be799f523f1b5b14cdcecbee1e0">00774</a> <span class="keywordtype">bool</span> <a class="code" href="class_b_a_m_read.html#a77171be799f523f1b5b14cdcecbee1e0">BAMRead::is_primary</a>()<span class="keyword"> const </span>{
<a name="l00775"></a>00775  assert(bam_record);
<a name="l00776"></a>00776  <span class="keywordflow">return</span> !(BAM_FSECONDARY &amp; bam_record-&gt;core.flag);
<a name="l00777"></a>00777  
<a name="l00778"></a>00778 }
<a name="l00779"></a>00779 
<a name="l00780"></a>00780 <span class="keyword">inline</span>
<a name="l00781"></a><a class="code" href="class_b_a_m_read.html#a19a7b642813b3bb41acfed7ccf11a4bc">00781</a> <span class="keywordtype">bool</span> <a class="code" href="class_b_a_m_read.html#a19a7b642813b3bb41acfed7ccf11a4bc">BAMRead::is_duplicate</a>()<span class="keyword"> const </span>{
<a name="l00782"></a>00782  assert(bam_record);
<a name="l00783"></a>00783  <span class="keywordflow">return</span> BAM_FDUP &amp; bam_record-&gt;core.flag;
<a name="l00784"></a>00784  
<a name="l00785"></a>00785 }
<a name="l00786"></a>00786 
<a name="l00787"></a>00787 <span class="keyword">inline</span>
<a name="l00788"></a><a class="code" href="class_b_a_m_read.html#a2bd07073d526f48485c2ac034572b3c4">00788</a> <span class="keywordtype">int</span> <a class="code" href="class_b_a_m_read.html#a2bd07073d526f48485c2ac034572b3c4">BAMRead::calend</a>()<span class="keyword"> const </span>{
<a name="l00789"></a>00789  
<a name="l00790"></a>00790  assert(bam_record);
<a name="l00791"></a>00791  <span class="keyword">const</span> bam1_core_t* c_tmp = &amp;(bam_record-&gt;core);
<a name="l00792"></a>00792  <span class="keyword">const</span> bam1_t* b_tmp = bam_record.get();
<a name="l00793"></a>00793  <span class="keywordflow">return</span> bam_calend(c_tmp, bam1_cigar(b_tmp));
<a name="l00794"></a>00794  
<a name="l00795"></a>00795  
<a name="l00796"></a>00796  
<a name="l00797"></a>00797 }
<a name="l00798"></a>00798 
<a name="l00799"></a>00799 
<a name="l00800"></a>00800 
<a name="l00801"></a>00801 <span class="preprocessor">#endif //BAMREAD_H</span>
<a name="l00802"></a>00802 <span class="preprocessor"></span>
<a name="l00803"></a>00803 
</pre></div></div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><b>BAMRead.h</b>      </li>
      <li class="footer">Generated on Tue Jun 28 2011 16:13:40 for SamUtils by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Friends</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>


</body>
</html>
