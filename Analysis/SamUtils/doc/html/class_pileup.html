<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>SamUtils: Pileup Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript">
$(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.4 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="300px-Lightning_storm_over_Boston_-_NOAA.jpg"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">SamUtils</div>
   <div id="projectbrief">Utility classes for working with SAM/BAM files.  Also provides some basic quality utilities</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('class_pileup.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a>  </div>
  <div class="headertitle">
<div class="title">Pileup Class Reference</div>  </div>
</div>
<div class="contents">
<!-- doxytag: class="Pileup" -->
<p><code>#include &lt;<a class="el" href="_pileup_8h_source.html">Pileup.h</a>&gt;</code></p>

<p><a href="class_pileup-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pileup.html#ab24ad8d1adc85141d279fa82645f9d67">Pileup</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pileup.html#af7a208f2f224582260aa4780f05156be">Pileup</a> (int tid, int pos, vector&lt; int &gt; &amp;phreds)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pileup.html#aa12195e46d05c2ef4bcd5c455af2fa27">Pileup</a> (int tid, int pos, vector&lt; int &gt; &amp;phreds, <a class="el" href="class_b_a_m_utils.html">BAMUtils</a> *_p)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pileup.html#a0ed467fc2ce855eee7a61b83059d8877">Pileup</a> (<a class="el" href="class_pileup.html">Pileup</a> const &amp;other)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_pileup.html">Pileup</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pileup.html#a4c65041c58658064b3de1ef715990fb1">operator=</a> (<a class="el" href="class_pileup.html">Pileup</a> that)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pileup.html#a5ef3f3c48d209a9297fa5d3edcc64918">insert_util</a> (<a class="el" href="class_b_a_m_utils.html">BAMUtils</a> *_p)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pileup.html#a54cb72913b0fde34d9a781f3f9a9a2d9">get_tid</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">coord_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pileup.html#a7c2e7c25ed33a0e62e8de528218b6107">get_pos</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pileup.html#a5fd72bbb7048f642b86bb668ae011124">get_num_reads</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pileup.html#ab83a8e4e308f82d44034ee8fbdea4859">is_covered</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pileup.html#a30556727363178d131bfe8648a18c77c">get_phred_cov</a> (int phred)</td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>This class aims to encapsulate one position in the reference sequence. It contains all of the reads that overlay this particular position. The read(s) may or may not actually have coverage at this position, however.</p>
<p>This class is retrieved from a <a class="el" href="class_pileup_factory.html">PileupFactory</a>. It's not recommended that you try and construct them yourself. </p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="ab24ad8d1adc85141d279fa82645f9d67"></a><!-- doxytag: member="Pileup::Pileup" ref="ab24ad8d1adc85141d279fa82645f9d67" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Pileup::Pileup </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Default constructor. A necessary evil in order to use these objects in STL containers </p>

</div>
</div>
<a class="anchor" id="af7a208f2f224582260aa4780f05156be"></a><!-- doxytag: member="Pileup::Pileup" ref="af7a208f2f224582260aa4780f05156be" args="(int tid, int pos, vector&lt; int &gt; &amp;phreds)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Pileup::Pileup </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>phreds</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>A light constructor that initializes the <a class="el" href="class_pileup.html">Pileup</a> with it's position, reference, and Phred scores The phred scores are used to see whether or not this read has some level of Phred coverage.</p>
<p>For instance, given phreds of 7,10,17,20,47 you can see how many Q7 bases cover this position, and how many Q47 bases cover this position, etc.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">int</td><td>tid index of reference in header of SAM/BAM file </td></tr>
    <tr><td class="paramname">int</td><td>pos position in reference </td></tr>
    <tr><td class="paramname">vector&lt;int&gt;</td><td>a vector of phred scores. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="class_pileup.html">Pileup</a> a constructed pileup object, but it doesn't contain reads yet. </dd></dl>

</div>
</div>
<a class="anchor" id="aa12195e46d05c2ef4bcd5c455af2fa27"></a><!-- doxytag: member="Pileup::Pileup" ref="aa12195e46d05c2ef4bcd5c455af2fa27" args="(int tid, int pos, vector&lt; int &gt; &amp;phreds, BAMUtils *_p)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Pileup::Pileup </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>phreds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_b_a_m_utils.html">BAMUtils</a> *&#160;</td>
          <td class="paramname"><em>_p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Convenience constructor if read already to be placed into the <a class="el" href="class_pileup.html">Pileup</a></p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">int</td><td>tid index of reference in header of SAM/BAM file </td></tr>
    <tr><td class="paramname">int</td><td>pos position in reference </td></tr>
    <tr><td class="paramname">vector&lt;int&gt;</td><td>phreds a vector of phred scores. </td></tr>
    <tr><td class="paramname">BAMUtils*</td><td>_p a pointer to a <a class="el" href="class_b_a_m_utils.html">BAMUtils</a> object that covers this read </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="class_pileup.html">Pileup</a> a constructed pileup object, but it doesn't contain reads yet. </dd></dl>

</div>
</div>
<a class="anchor" id="a0ed467fc2ce855eee7a61b83059d8877"></a><!-- doxytag: member="Pileup::Pileup" ref="a0ed467fc2ce855eee7a61b83059d8877" args="(Pileup const &amp;other)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Pileup::Pileup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pileup.html">Pileup</a> const &amp;&#160;</td>
          <td class="paramname"><em>other</em></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>A copy constructor </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname"><a class="el" href="class_pileup.html">Pileup</a></td><td>const&amp; other an existing <a class="el" href="class_pileup.html">Pileup</a> object </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="class_pileup.html">Pileup</a> a copy of other </dd></dl>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a5fd72bbb7048f642b86bb668ae011124"></a><!-- doxytag: member="Pileup::get_num_reads" ref="a5fd72bbb7048f642b86bb668ae011124" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long Pileup::get_num_reads </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Returns the number of reads that overlap this position (not necessarily cover it).</p>
<p>For instance, if this position in the sample is a deletion to the reference, and all the reads that overlap this position observe that deletion the position will technically not have any coverage.</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>long number of reads </dd></dl>

</div>
</div>
<a class="anchor" id="a30556727363178d131bfe8648a18c77c"></a><!-- doxytag: member="Pileup::get_phred_cov" ref="a30556727363178d131bfe8648a18c77c" args="(int phred)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Pileup::get_phred_cov </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>phred</em></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Returns the level of Phred coverage at this position. So, if we have 10 Q47 reads that map here and this position is within the Q47 length of all 10 reads, the return value will be 10.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">int</td><td>phred Phred score we're interested in </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>int level of coverage </dd></dl>

</div>
</div>
<a class="anchor" id="a7c2e7c25ed33a0e62e8de528218b6107"></a><!-- doxytag: member="Pileup::get_pos" ref="a7c2e7c25ed33a0e62e8de528218b6107" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">coord_t Pileup::get_pos </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Returns position in reference that this <a class="el" href="class_pileup.html">Pileup</a> corresopnds to</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>long position in genome </dd></dl>

</div>
</div>
<a class="anchor" id="a54cb72913b0fde34d9a781f3f9a9a2d9"></a><!-- doxytag: member="Pileup::get_tid" ref="a54cb72913b0fde34d9a781f3f9a9a2d9" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Pileup::get_tid </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Returns the index of the reference in the SAM/BAM header file</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>int index of reference </dd></dl>

</div>
</div>
<a class="anchor" id="a5ef3f3c48d209a9297fa5d3edcc64918"></a><!-- doxytag: member="Pileup::insert_util" ref="a5ef3f3c48d209a9297fa5d3edcc64918" args="(BAMUtils *_p)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Pileup::insert_util </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_b_a_m_utils.html">BAMUtils</a> *&#160;</td>
          <td class="paramname"><em>_p</em></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Inserts a <a class="el" href="class_b_a_m_utils.html">BAMUtils</a> object into this position. This function will check to make sure the read covers this position. If the read doesn't cover the position, the input pointer is disregarded</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">BAMUtils*</td><td>_p pointer to a <a class="el" href="class_b_a_m_utils.html">BAMUtils</a> object that you think covers this position </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ab83a8e4e308f82d44034ee8fbdea4859"></a><!-- doxytag: member="Pileup::is_covered" ref="ab83a8e4e308f82d44034ee8fbdea4859" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Pileup::is_covered </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>A convenience method that will simply return whether or not there is SOMETHING covering this position. This can save you computation if there is a _lot_ of coverage at a position.</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>bool true if position is covered </dd></dl>

</div>
</div>
<a class="anchor" id="a4c65041c58658064b3de1ef715990fb1"></a><!-- doxytag: member="Pileup::operator=" ref="a4c65041c58658064b3de1ef715990fb1" args="(Pileup that)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_pileup.html">Pileup</a>&amp; Pileup::operator= </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pileup.html">Pileup</a>&#160;</td>
          <td class="paramname"><em>that</em></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Overloaded operator= which calls the copy constructor </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname"><a class="el" href="class_pileup.html">Pileup</a></td><td>that an existing <a class="el" href="class_pileup.html">Pileup</a> object </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="class_pileup.html">Pileup</a> a copy of that </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>types/<a class="el" href="_pileup_8h_source.html">Pileup.h</a></li>
</ul>
</div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="class_pileup.html">Pileup</a>      </li>
      <li class="footer">Generated on Tue Jun 28 2011 16:13:41 for SamUtils by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Friends</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>


</body>
</html>
