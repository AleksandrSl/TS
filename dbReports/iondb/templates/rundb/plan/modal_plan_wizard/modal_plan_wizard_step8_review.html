<div class="row-fluid">
    <div class="span12">
        {% if intent == "New" or intent == "Copy" or intent == "Edit" %}
        <a href="#" class="btn review_plan_inline">Review Template &nbsp;+</a>
        {% else %}
        <a href="#" class="btn review_plan_inline">Review Run Plan &nbsp;+</a>
        {% endif %}
    </div>

    <div class="review_plan_info row-fluid" style="display: none;">
        <div class="span4">
            <br>
            <h3>Application</h3>

            {% if selectedApplProductData %}
                <p>
                <table class="plan-grid">
                    <tr>
                        <td width="50%" style="line-height:100%; font-weight: bold;">Application:</td>
                        <td width="50%" id="review_application" style="line-height:100%;" >{{selectedApplProductData.runType.description}}</td>
                    </tr>
                    <tr>
                        <td width="50%" style="line-height:100%; font-weight: bold;">Run type:</td>
                        {% if selectedApplProductData.isDefaultPairedEnd %}
                            <td width="50%"  id="review_runType" style="line-height:100%;">Paired-End</td>
                        {% else %}
                            <td width="50%"  id="review_runType" style="line-height:100%;">Fragment</td>
                        {% endif %}
                    </tr>
                </table>
                </p>
                <br>

                <h3>Kits</h3>
                <p>
                <p style="line-height:100%; font-weight: bold;">Sample Preparation Kit:</p>
                <p style="line-height:100%; margin:10px;" id="review_samplePrepKitName"></p>

                {% if selectedApplProductData.isDefaultPairedEnd %}
                    <p style="line-height:100%; font-weight: bold;">Library Kit Type:</p>
                    <p style="line-height:100%; margin:10px;" id="review_libKit">{{selectedApplProductData.peLibKit.name}}</p>
                {% else %}
                    <p style="line-height:100%; font-weight: bold;">Library Kit Type:</p>
                    <p style="line-height:100%; margin:10px;" id="review_libKit">{{selectedApplProductData.libKit.name}}</p>
                {% endif %}

                <div class="review_extra_kit_info row-fluid" style="display: none;">
                    {% if selectedApplProductData %}
                        <p style="line-height:100%; font-weight: bold;">Forward Library Key:</p>
                        <p style="line-height:100%; margin:10px;" id="review_forwardLibKey"></p>

                        <p style="line-height:100%; font-weight: bold;">Forward 3' Adapter</p>
                        <p style="line-height:100%; margin:10px;" id="review_forward3Adapter"></p>
                    {% else %}
                        <p style="line-height:100%; font-weight: bold;">Forward Library Key:</p>
                        <p style="line-height:100%; margin:10px;" id="review_forwardLibKey">{{selectedPlanTemplate.libraryKey}}</p>

                        <p style="line-height:100%; font-weight: bold;">Forward 3' Adapter</p>
                        <p style="line-height:100%; margin:10px;" id="review_forward3Adapter">{{selectedPlanTemplate.forward3primeadapter}}</p>
                    {% endif %}
                </div>

                <div class="review_extra_pe_kit_info row-fluid" style="display: none;">
                    {% if selectedApplProductData %}
                        <p style="line-height:100%; font-weight: bold;">Forward Library Key:</p>
                        <p style="line-height:100%; margin:10px;" id="review_peForwardLibKey"></p>

                        <p style="line-height:100%; font-weight: bold;">Forward 3' Adapter:</p>
                        <p style="line-height:100%; margin:10px;" id="review_peForward3Adapter"></p>

                        <p style="line-height:100%; font-weight: bold;">Reverse Library Key:</p>
                        <p style="line-height:100%; margin:10px;" id="review_peReverseLibKey"></p>

                        <p style="line-height:100%; font-weight: bold;">Reverse 3' Adapter:</p>
                        <p style="line-height:100%; margin:10px;" id="review_peReverse3Adapter"></p>

                        <p style="line-height:100%; font-weight: bold;">Paired-End Library Adapter:</p>
                        <p style="line-height:100%; margin:10px;" id="review_peLibAdapter"></p>
                    {% else %}
                        <p style="line-height:100%; font-weight: bold;">Forward Library Key:</p>
                        <p style="line-height:100%; margin:10px;" id="review_peForwardLibKey">{{selectedPlanTemplate.libraryKey}}</p>

                        <p style="line-height:100%; font-weight: bold;">Forward 3' Adapter:</p>
                        <p style="line-height:100%; margin:10px;" id="review_peForward3Adapter">{{selectedPlanTemplate.forward3primeadapter}}</p>

                        <p style="line-height:100%; font-weight: bold;">Reverse Library Key:</p>
                        <p style="line-height:100%; margin:10px;" id="review_peReverseLibKey">{{selectedPlanTemplate.reverselibrarykey}}</p>

                        <p style="line-height:100%; font-weight: bold;">Reverse 3' Adapter:</p>
                        <p style="line-height:100%; margin:10px;" id="review_peReverse3Adapter">{{selectedPlanTemplate.reverse3primeadapter}}</p>

                        <p style="line-height:100%; font-weight: bold;">Paired-End Library Adapter:</p>
                        <p style="line-height:100%; margin:10px;" id="review_peLibAdapter">{{selectedPlanTemplate.pairedEndLibraryAdapterName}}</p>
                    {% endif %}
                </div>

                <p style="line-height:100%; font-weight: bold;">Template Kit: </p>
                {% if selectedApplProductData %}
                	<p style="line-height:100%; margin:10px;" id="review_templateKit">{{selectedApplProductData.defaultOneTouchTemplateKit.name}}</p>
                {% else %}
            		<p style="line-height:100%; margin:10px;" id="review_templateKit">{{selectedPlanTemplate.templatingKitName}}</p>
            	{% endif %}
            	
                {% if selectedApplProductData.isDefaultPairedEnd %}
                    <p style="line-height:100%; font-weight: bold;">Sequencing Kit:</p>
                    <p style="line-height:100%; margin:10px;" id="review_seqKit">{{selectedApplProductData.peSeqKit.name}}</p>
                {% else %}
                    <p style="line-height:100%; font-weight: bold;">Sequencing Kit:</p>
                    <p style="line-height:100%; margin:10px;" id="review_seqKit">{{selectedApplProductData.seqKit.name}}</p>
                {% endif %}

                {% if selectedApplProductData.isDefaultPairedEnd %}
                    <p>
                    <table class="plan-grid">
                        <tr>
                            <td width="50%" style="line-height:100%; font-weight: bold;">Flows: </td>
                            <td width="50%" id="review_flowCount" style="line-height:100%;" >{{selectedApplProductData.peSeqKit.flowCount}}</td>
                        </tr>
                    </table>
                    </p>
                {% else %}
                    <p>
                    <table class="plan-grid">
                        <tr>
                            <td width="50%" style="line-height:100%; font-weight: bold;">Flows: </td>
                            <td width="50%" id="review_flowCount" style="line-height:100%;" >{{selectedApplProductData.seqKit.flowCount}}</td>
                        </tr>
                    </table>
                    </p>
                {% endif %}
                <br>

                <p style="line-height:100%; font-weight: bold;">Barcode Set (optional): </p>
                <p style="line-height:100%; margin:10px;" id="review_barcodeKit"></p>

                <p style="line-height:100%; font-weight: bold;">Control Sequence (optional): </p>
                <p style="line-height:100%; margin:10px;" id="review_controlSeq"></p>

                <p>
                <table class="plan-grid">
                    <tr>
                        <td width="50%" style="line-height:100%; font-weight: bold;">Chip Type: </td>
                        {% if selectedApplProductData.chipType %}
                            <td width="70%" id="review_chipType" style="line-height:100%;" >Ion {{selectedApplProductData.chipType}}&trade; Chip</td>
                        {% else %}
                            {% if selectedChipTypeDetails %}
                                <td width="70%" id="review_chipType" style="line-height:100%;" >Ion {{selectedChipTypeDetails.getChipDisplayedName}}&trade; Chip</td>
                            {% else %}
                                <td width="70%" id="review_chipType" style="line-height:100%;" ></td>
                            {% endif %}
                        {% endif %}
                    </tr>
                </table>
                </p>
                <p>
                <table class="plan-grid">
                    <tr>
                        <td width="50%" style="line-height:100%; font-weight: bold;">Mark as PCR Duplicates: </td>
                        {% if selectedApplProductData %}
                            <td width="100%" id="review_isDuplicateReads" style="line-height:100%;" ></td>
                        {% else %}
                            <td width="70%" id="review_isDuplicateReads" style="line-height:100%;" >{{selectedPlanTemplate.isDuplicateReads}}</td>
                        {% endif %}
                    </tr>
                </table>
                
                </p>
            {% else %}
                <h3>Kits</h3>
                <p>
                <p style="line-height:100%; font-weight: bold;">Sample Preparation Kit:</p>
                <p style="line-height:100%; margin:10px;" id="review_samplePrepKitName">{{selectedPlanTemplate.samplePrepKitName}}</p>

                <p style="line-height:100%; font-weight: bold;">Library Kit Type:</p>
                <p style="line-height:100%; margin:10px;" id="review_libKit">{{selectedPlanTemplate.librarykitname}}</p>

                <div class="review_extra_kit_info row-fluid" style="display: none;">
                        <p style="line-height:100%; font-weight: bold;">Forward Library Key:</p>
                        <p style="line-height:100%; margin:10px;" id="review_forwardLibKey">{{selectedPlanTemplate.libraryKey}}</p>

                        <p style="line-height:100%; font-weight: bold;">Forward 3' Adapter</p>
                        <p style="line-height:100%; margin:10px;" id="review_forward3Adapter">{{selectedPlanTemplate.forward3primeadapter}}</p>
                </div>

                <div class="review_extra_pe_kit_info row-fluid" style="display: none;">
                        <p style="line-height:100%; font-weight: bold;">Forward Library Key:</p>
                        <p style="line-height:100%; margin:10px;" id="review_peForwardLibKey">{{selectedPlanTemplate.libraryKey}}</p>

                        <p style="line-height:100%; font-weight: bold;">Forward 3' Adapter:</p>
                        <p style="line-height:100%; margin:10px;" id="review_peForward3Adapter">{{selectedPlanTemplate.forward3primeadapter}}</p>

                        <p style="line-height:100%; font-weight: bold;">Reverse Library Key:</p>
                        <p style="line-height:100%; margin:10px;" id="review_peReverseLibKey">{{selectedPlanTemplate.reverselibrarykey}}</p>

                        <p style="line-height:100%; font-weight: bold;">Reverse 3' Adapter:</p>
                        <p style="line-height:100%; margin:10px;" id="review_peReverse3Adapter">{{selectedPlanTemplate.reverse3primeadapter}}</p>

                        <p style="line-height:100%; font-weight: bold;">Paired-End Library Adapter:</p>
                        <p style="line-height:100%; margin:10px;" id="review_peLibAdapter">{{selectedPlanTemplate.pairedEndLibraryAdapterName}}</p>
                </div>

                <p style="line-height:100%; font-weight: bold;">Template Kit: </p>
                <p style="line-height:100%; margin:10px;" id="review_templateKit">{{selectedPlanTemplate.templatingKitName}}</p>

                <p style="line-height:100%; font-weight: bold;">Sequencing Kit:</p>
                <p style="line-height:100%; margin:10px;" id="review_seqKit">{{selectedPlanTemplate.sequencekitname}}</p>

                <p>
                <table class="plan-grid">
                    <tr>
                        <td width="50%" style="line-height:100%; font-weight: bold;">Flows: </td>
                        <td width="50%" id="review_flowCount" style="line-height:100%;" >{{selectedPlanTemplate.flows}}</td>
                    </tr>
                </table>
                </p>

                <p style="line-height:100%; font-weight: bold;" >Barcode Set (optional):</p>
                <p style="line-height:100%; margin:10px;" id="review_barcodeKit">{{selectedPlanTemplate.barcodeId}} </p>

                <p style="line-height:100%; font-weight: bold;">Control Sequence (optional): </p>
                <p style="line-height:100%; margin:10px;" id="review_controlSeq">{{selectedPlanTemplate.controlSequencekitname}}</p>

                <p>
                <table class="plan-grid">
                    <tr>
                        <td width="50%" style="line-height:100%; font-weight: bold;">Chip Type: </td>
                        {% if selectedApplProductData.chipType %}
                            <td width="100%" id="review_chipType" style="line-height:100%;" >Ion {{selectedPlanTemplate.chipType}}&trade; Chip</td>
                        {% else %}
                            {% if selectedChipTypeDetails %}
                                <td width="70%" id="review_chipType" style="line-height:100%;" >Ion {{selectedChipTypeDetails.getChipDisplayedName}}&trade; Chip</td>
                            {% else %}
                                <td width="70%" id="review_chipType" style="line-height:100%;" ></td>
                            {% endif %}
                        {% endif %}
                    </tr>
                </table>                
                </p>

                <p>
                <table class="plan-grid">
                    <tr>
                        <td width="50%" style="line-height:100%; font-weight: bold;">Mark as PCR Duplicates: </td>
                        {% if selectedApplProductData %}
                            <td width="100%" id="review_isDuplicateReads" style="line-height:100%;" ></td>
                        {% else %}
                            <td width="70%" id="review_isDuplicateReads" style="line-height:100%;" >{{selectedPlanTemplate.isDuplicateReads}}</td>
                        {% endif %}
                    </tr>
                </table>
                
                </p>                
            {% endif %}
            <br>
        </div>

        <div class="span4">
            <br>
            <h3>Monitor</h3>
            <p>
            <table class="plan-grid">
                {% if selectedApplProductData %}
                    {% for qcType in planTemplateData.qcTypes %}
                        <tr>
                            <td width="70%" style="line-height:100%; font-weight: bold;">{{qcType.qcName}}: <span>&le; </span></td>
                            <td width="30%" id="review_qcValues_{{forloop.counter}}" style="line-height:100%;">{{qcType.defaultThreshold}}</td>
                        </tr>
                    {% endfor %}
                {% else %}
                    {% for qcType in planTemplateData.qcTypes %}
                        {% with selectedPlanTemplate.plannedexperimentqc_set.all as selectedPlanTemplateQCs %}
                        {% if selectedPlanTemplateQCs %}
                            {% for qcValue in selectedPlanTemplateQCs %}
                                {% ifequal qcType.qcName qcValue.qcType.qcName %}
                                    <tr>
                                        <td width="70%" style="line-height:100%; font-weight: bold;">{{qcType.qcName}}: <span>&le; </span></td>
                                        <td width="30%" id="review_qcValues_{{forloop.counter}}" style="line-height:100%;">{{qcValue.threshold}}</td>
                                    </tr>
                                {% endifequal %}
                            {% endfor %}
                        {% endif %}
                        {% endwith %}
                    {% endfor %}
                {% endif %}
            </table>
            </p>
            <br>
    
            <h3>Reference</h3>
            <p>
                {% if selectedApplProductData %}
                    <p style="line-height:50%; font-weight: bold;" >Reference Library:</p>
                    <p style="line-height:50%; margin:10px;" id="review_refLib">{{selectedApplProductData.reference}}</p>
                    <p style="line-height:50%; font-weight: bold;">Target Regions BED File:</p>
                    <p style="line-height:100%; margin:10px; word-wrap:break-word; word-break: break-all;" id="review_bedfile">{{selectedApplProductData.targetBedFile}}</p>
                    <p style="line-height:50%; font-weight: bold;">Hotspot Regions BED File:</p>
                    <p style="line-height:100%; margin:10px; word-wrap:break-word; word-break: break-all;" id="review_regionfile">{{selectedApplProductData.hotSpotBedFile}}</p>
                {% else %}
                    <p style="line-height:50%; font-weight: bold;">Reference Library:</p>
                    <p style="line-height:50%; margin:10px;" id="review_refLib">{{selectedPlanTemplate.library}}</p>
                    <p style="line-height:50%; font-weight: bold;">Target Regions BED File:</p>
                    <p style="line-height:100%; margin:10px; word-wrap:break-word; word-break: break-all;" id="review_bedfile">{{selectedPlanTemplate.bedfile}}</p>
                    <p style="line-height:50%; font-weight: bold;">Hotspot Regions BED File:</p>
                    <p style="line-height:100%; margin:10px; word-wrap:break-word; word-break: break-all;" id="review_regionfile">{{selectedPlanTemplate.regionfile}}</p>
                {% endif %}
            </p>
        </div>

        <div class="span4">
            <br>
            <h3>Plugins</h3>
            <p>
            <p style="line-height:50%; font-weight: bold;" >Selected plugin(s): </p>
    
            <p style="line-height:100%; margin:10px" id="review_selectedPlugins">
            <!--20120717-TODO-need selected plugins for the persisted plan/template>
            {% if not selectedApplProductData %}
                {% for plugin in planTemplateData.plugins %}
                    {{plugin.name}} v{{plugin.version}}&#44
                {% endfor %}
            {% endif %}
            -->
            </p>
    
            <h3>Projects</h3>
            <p>
            <p style="line-height:100%; margin:10px" id="review_projects">
            {% if not selectedApplProductData %}
                {% with selectedPlanTemplate.projects.all as selectedPlanTemplateProjects %}
                {% for project in selectedPlanTemplateProjects %}
                    {{project.name}}&#44
                {% endfor %}
                {% endwith %}
            {% endif %}
            </p>
            <p style="line-height:100%; margin:10px" id="review_projects2">
            </p>
    
            <h3>Export</h3>
            <p>
            <p style="line-height:100%; margin:10px" id="review_export">
            <!-- 20120717-TODO-need selected uploaders for the persisted plan/template>
            {% if not selectedApplProductData %}
                {% for uploader in planTemplateData.uploader %}
                    {{uploader.name}} v{{uploader.version}}&#44
                {% endfor %}
            {% endif %}
            -->
            </p>
        </div>
    </div>
</div><!-- row-fluid -->
