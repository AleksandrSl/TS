<!-- KITS -->
<div id="ws-2" class="workflow-step " style="display: none;">
    <div class="workflow-step-content">
        <table class="plan-grid">
            <tr>
                <td width="65%">
                <p class="form-label">Sample Preparation Kit (optional):</p>
                <select id="samplePrepKitName" name="samplePrepKitName" value="" class="select-group" style="width:350px;">
                <option value=""></option>
                {% for samplePrepKit in planTemplateData.samplePrepKits %}
                    {% if selectedApplProductData %}
                        {% ifequal samplePrepKit.name selectedApplProductData.defaultSamplePrepKit.name %}
                            <option SELECTED value="{{samplePrepKit.name}}">{{samplePrepKit}}</option>
                        {% else %}
                            <option value="{{samplePrepKit.name}}">{{samplePrepKit}}</option>
                        {% endifequal %}
                    {% else %}
                        {% ifequal samplePrepKit.name selectedPlanTemplate.samplePrepKitName %}
                            <option SELECTED value="{{samplePrepKit.name}}">{{samplePrepKit}}</option>
                        {% else %}
                            <option value="{{samplePrepKit.name}}">{{samplePrepKit}}</option>
                        {% endifequal %}
                    {% endif %}

                {% endfor %}
                </select>
                </td>

                <td  width="35%">
                <p class="form-label">Barcode Set (optional):</p>
                <input value="False" name="isBarcodedPlan" id="isBarcodedPlan" type="hidden"/>

                <select id="barcodeName" name="barcodeId" value="" class="select-group"  style="width:250px;">
                <option value=""></option>
                {% for barcodeKit in planTemplateData.barcodes %}
                    {% if selectedApplProductData %}
                    	{% if selectedApplProductData.isDefaultBarcoded %}
                        	{% ifequal barcodeKit.name selectedApplProductData.defaultBarcodeKitName %}
                        		<option SELECTED value="{{barcodeKit.name}}">{{barcodeKit.name}}</option>
                        	{% else %}
                        		<option value="{{barcodeKit.name}}">{{barcodeKit.name}}</option>
                        	{% endifequal %}
                        {% else %}
                			<option value="{{barcodeKit.name}}">{{barcodeKit.name}}</option>
                    	{% endif %}                        
                    {% else %}
                        {% ifequal barcodeKit.name selectedPlanTemplate.barcodeId %}
                            <option SELECTED value="{{barcodeKit.name}}">{{barcodeKit.name}}</option>
                        {% else %}
                            <option value="{{barcodeKit.name}}">{{barcodeKit.name}}</option>
                        {% endifequal %}
                    {% endif %}
                {% endfor %}
                </select>
                </td>
            </tr>

            <tr>
                <td width="65%">
                    <p class="form-label">Library Kit Type:
                    <a href="#" class="btn extra_kit_inline">Details &nbsp;+</a>
                    </p>
                    <select id="librarykitname" name="librarykitname" value="" class="select-group"  style="width:350px;">
                    <option value=""></option>
                    {% for libKit in planTemplateData.libKits %}
                        {% if selectedApplProductData %}
                            {% if selectedApplProductData.isDefaultPairedEnd  %}
                                {% ifequal libKit.name selectedApplProductData.peLibKit.name %}
                                    <option SELECTED value="{{libKit.name}}">{{libKit}}</option>
                                {% else %}
                                    <option value="{{libKit.name}}">{{libKit}}</option>
                                {% endifequal %}
                            {% else %}
                                {% ifequal libKit.name selectedApplProductData.libKit.name %}
                                    <option SELECTED value="{{libKit.name}}">{{libKit}}</option>
                                {% else %}
                                    <option value="{{libKit.name}}">{{libKit}}</option>
                                {% endifequal %}
                            {% endif %}
                        {% else %}
                            {% ifequal libKit.name selectedPlanTemplate.librarykitname %}
                                <option SELECTED value="{{libKit.name}}">{{libKit}}</option>
                            {% else %}
                                <option value="{{libKit.name}}">{{libKit}}</option>
                            {% endifequal %}
                        {% endif %}

                    {% endfor %}
                    </select>
                </td>

            </tr>
        </table>

        <div class="extra_kit_forward_info row-fluid" style="display: none;">
            <table class="plan-grid">
                <tr>
                    <td width="65%">
                        <p class="form-label">Forward Library Key:</p>
                        <select id="libraryKey" name="libraryKey" value="" class="select-group"  style="width:350px;">
                        <option value=""></option>

                        {% for libKey in planTemplateData.forwardLibKeys %}
                            {% if selectedApplProductData %}
                                {% if libKey.isDefault %}
                                    {% ifequal libKey.runMode 'single' %}
                                        <option SELECTED value="{{libKey.sequence}}">{{libKey}}</option>
                                    {% else %}
                                        <option value="{{libKey.sequence}}">{{libKey}}</option>
                                    {% endifequal %}
                                {% else %}
                                    <option value="{{libKey.sequence}}">{{libKey}}</option>
                                {% endif %}
                            {% else %}
                                {% ifequal libKey.sequence selectedPlanTemplate.libraryKey %}
                                    <option SELECTED value="{{libKey.sequence}}">{{libKey}}</option>
                                {% else %}
                                    <option value="{{libKey.sequence}}">{{libKey}}</option>
                                {% endifequal %}
                            {% endif %}

                        {% endfor %}
                        </select>
                    </td>

                    <td width="35%">
                        <p class="form-label">Forward 3' Adapter:</p>
                        <select id="forward3primeAdapter" name="forward3primeAdapter" value="" class="select-group"  style="width:250px;">
                        <option value=""></option>

                        {% for adapter in planTemplateData.forward3Adapters %}
                            {% if selectedApplProductData %}
                                {% if adapter.isDefault %}
                                    {% ifequal adapter.runMode 'single' %}
                                        <option SELECTED value="{{adapter.sequence}}">{{adapter}}</option>
                                    {% else %}
                                        <option value="{{adapter.sequence}}">{{adapter}}</option>
                                    {% endifequal %}
                                {% else %}
                                    <option value="{{adapter.sequence}}">{{adapter}}</option>
                                {% endif %}
                            {% else %}
                                {% ifequal adapter.sequence selectedPlanTemplate.forward3primeadapter %}
                                    <option SELECTED value="{{adapter.sequence}}">{{adapter}}</option>
                                {% else %}
                                    <option value="{{adapter.sequence}}">{{adapter}}</option>
                                {% endifequal %}
                            {% endif %}

                        {% endfor %}
                        </select>
                    </td>
                </tr>
            </table>
            <!--/div -->
            <br>
        </div>

        <div class="extra_kit_pe_forward_info row-fluid" style="display: none;">
            <table class="plan-grid">
                <tr>
                    <td width="65%">
                        <p class="form-label">Forward Library Key:</p>
                        <select id="peForwardLibraryKey" name="peForwardLibraryKey" value="" class="select-group" style="width:350px;">
                        <option value=""></option>

                        {% for libKey in planTemplateData.peForwardLibKeys %}
                            {% if selectedApplProductData %}
                                {% if libKey.isDefault %}
                                    {% ifequal libKey.runMode 'single' %}
                                        <option SELECTED value="{{libKey.sequence}}">{{libKey}}</option>
                                    {% else %}
                                        <option value="{{libKey.sequence}}">{{libKey}}</option>
                                    {% endifequal %}
                                {% else %}
                                    <option value="{{libKey.sequence}}">{{libKey}}</option>
                                {% endif %}
                            {% else %}
                                {% ifequal libKey.sequence selectedPlanTemplate.libraryKey %}
                                    <option SELECTED value="{{libKey.sequence}}">{{libKey}}</option>
                                {% else %}
                                    <option value="{{libKey.sequence}}">{{libKey}}</option>
                                {% endifequal %}
                            {% endif %}

                        {% endfor %}
                        </select>
                    </td>

                    <td width="35%">
                        <p class="form-label">Forward 3' Adapter:</p>
                        <select id="peForward3primeAdapter" name="peForward3primeAdapter" value="" class="select-group"  style="width:250px;">
                        <option value=""></option>

                        {% for adapter in planTemplateData.peForward3Adapters %}
                            {% if selectedApplProductData %}
                                {% ifequal adapter.runMode 'pe' %}
                                    {% ifequal adapter.name 'Ion Paired End Fwd' %}
                                        <option SELECTED value="{{adapter.sequence}}">{{adapter}}</option>
                                    {% else %}
                                        <option value="{{adapter.sequence}}">{{adapter}}</option>
                                    {% endifequal %}
                                {% else %}
                                    <option value="{{adapter.sequence}}">{{adapter}}</option>
                                {% endifequal %}
                            {% else %}
                                {% ifequal adapter.sequence selectedPlanTemplate.forward3primeadapter %}
                                    <option SELECTED value="{{adapter.sequence}}">{{adapter}}</option>
                                {% else %}
                                    <option value="{{adapter.sequence}}">{{adapter}}</option>
                                {% endifequal %}
                            {% endif %}

                        {% endfor %}
                        </select>
                    </td>
                </tr>
            </table>
        </div>

        <div class="extra_kit_pe_reverse_info row-fluid" style="display: none;">
            <table class="plan-grid">
                <tr>
                    <td width="65%">
                        <p class="form-label">Reverse Library Key:</p>
                        <select id="reverselibrarykey" name="reverselibrarykey" value="" class="select-group" style="width:350px;">
                        <option value=""></option>

                        {% for libKey in planTemplateData.reverseLibKeys %}
                            {% if selectedApplProductData %}
                                {% if libKey.isDefault %}
                                    {% ifequal libKey.runMode 'pe' %}
                                        <option SELECTED value="{{libKey.sequence}}">{{libKey}}</option>
                                    {% else %}
                                        <option value="{{libKey.sequence}}">{{libKey}}</option>
                                    {% endifequal %}
                                {% else %}
                                    <option value="{{libKey.sequence}}">{{libKey}}</option>
                                {% endif %}
                            {% else %}
                                {% ifequal libKey.sequence selectedPlanTemplate.reverselibrarykey %}
                                    <option SELECTED value="{{libKey.sequence}}">{{libKey}}</option>
                                {% else %}
                                    <option value="{{libKey.sequence}}">{{libKey}}</option>
                                {% endifequal %}
                            {% endif %}

                        {% endfor %}
                        </select>
                    </td>

                    <td width="35%">
                        <p class="form-label">Reverse 3' Adapter:</p>
                        <select id="reverse3primeAdapter" name="reverse3primeAdapter" value="" class="select-group"  style="width:250px;">
                        <option value=""></option>

                        {% for adapter in planTemplateData.reverse3Adapters %}
                            {% if selectedApplProductData %}
                                {% if adapter.isDefault %}
                                    {% ifequal adapter.runMode 'pe' %}
                                        <option SELECTED value="{{adapter.sequence}}">{{adapter}}</option>
                                    {% else %}
                                        <option value="{{adapter.sequence}}">{{adapter}}</option>
                                    {% endifequal %}
                                {% else %}
                                    <option value="{{adapter.sequence}}">{{adapter}}</option>
                                {% endif %}
                            {% else %}
                                {% ifequal adapter.sequence selectedPlanTemplate.reverse3primeadapter %}
                                    <option SELECTED value="{{adapter.sequence}}">{{adapter}}</option>
                                {% else %}
                                    <option value="{{adapter.sequence}}">{{adapter}}</option>
                                {% endifequal %}
                            {% endif %}

                        {% endfor %}
                        </select>
                    </td>
                </tr>
                <tr>
                    <td width="65%">
                    <p class="form-label">Paired-End Library Adapter:</p>
                    <select id="pairedEndLibraryAdapterName" name="pairedEndLibraryAdapterName" value="" class="select-group"  style="width:350px;">
                    <option value=""></option>

                    {% for adapter in planTemplateData.pairedEndLibAdapters %}
                        {% if selectedApplProductData %}
                            {% ifequal adapter.name "Paired-end library adapter kit" %}
                                <option SELECTED value="{{adapter.name}}">{{adapter}}</option>
                            {% else %}
                                <option value="{{adapter.name}}">{{adapter}}</option>
                            {% endifequal %}
                        {% else %}
                            {% ifequal adapter.name selectedPlanTemplate.pairedEndLibraryAdapterName %}
                                <option SELECTED value="{{adapter.name}}">{{adapter}}</option>
                            {% else %}
                                <option value="{{adapter.name}}">{{adapter}}</option>
                            {% endifequal %}
                        {% endif %}

                    {% endfor %}
                    </select>
                    </td>
                </tr>
            </table>
            <br>
        </div>

        <table class="plan-grid">
            <tr>
                <td width="65%">
                    <p class="form-label">Template Kit:   
                    <span class="option-group">
                    <small style="font-weight: normal; font-size: 75%;">
                    	{% if selectedApplProductData %}
                    		<input checked="checked" type="radio" id="samplePrepInstrumentType" name="samplePrepInstrumentType" value="oneTouch" >OneTouch
                    		<input type="radio" id="samplePrepInstrumentType" name="samplePrepInstrumentType" value="ionChef">IonChef
                    	{% else %}
                    		{% if selectedPlanTemplate.isIonChef %}
                    			<input type="radio" id="samplePrepInstrumentType" name="samplePrepInstrumentType" value="oneTouch" >OneTouch
                    			<input checked="checked" type="radio" id="samplePrepInstrumentType" name="samplePrepInstrumentType" value="ionChef">IonChef
                    		{% else %}
                        		<input checked="checked" type="radio" id="samplePrepInstrumentType" name="samplePrepInstrumentType" value="oneTouch" >OneTouch
                        		<input type="radio" id="samplePrepInstrumentType" name="samplePrepInstrumentType" value="ionChef">IonChef
                        	{% endif %}
                    	{% endif %}
                    </small>
                    </span>
                    </p>

                    <div class="template_kit_oneTouch row-fluid" style="display: none;">
                    <select id="templatekitname" name="templatekitname" value="" class="select-group" style="width:350px;">
                    <option value="" style="width:50px;"></option>
                    {% for templateKit in planTemplateData.templateKits %}
                        {% if selectedApplProductData %}
                            {% ifequal templateKit.name selectedApplProductData.defaultOneTouchTemplateKit.name %}
                                <option SELECTED value="{{templateKit.name}}">{{templateKit.name}}</option>
                            {% else %}
                                <option value="{{templateKit.name}}">{{templateKit.name}}</option>
                            {% endifequal %}
                        {% else %}
                            {% ifequal templateKit.name selectedPlanTemplate.templatingKitName %}
                                <option SELECTED value="{{templateKit.name}}">{{templateKit.name}}</option>
                            {% else %}
                                <option value="{{templateKit.name}}">{{templateKit.name}}</option>
                            {% endifequal %}
                        {% endif %}
                    {% endfor %}
                    </select>
                    </div>
                    
                    <div class="template_kit_ionChef row-fluid" style="display: none;">                    
                    <select id="templatekitionchefname" name="templatekitionchefname" value="" class="select-group"  style="width:350px;">
                    <option value="" style="width:50px;"></option>
                    {% for templateKit in planTemplateData.ionChefKits %}
                        {% if selectedApplProductData %}
                        	{% ifequal templateKit.name selectedApplProductData.defaultIonChefKit.name %}
                        		<option SELECTED value="{{templateKit.name}}">{{templateKit.name}}</option>
                        	{% else %}
                        		<option value="{{templateKit.name}}">{{templateKit.name}}</option>
                        	{% endifequal %}
                        {% else %}
                            {% ifequal templateKit.name selectedPlanTemplate.templatingKitName %}
                                <option SELECTED value="{{templateKit.name}}">{{templateKit.name}}</option>
                            {% else %}
                                <option value="{{templateKit.name}}">{{templateKit.name}}</option>
                            {% endifequal %}
                        {% endif %}
                    {% endfor %}
                    </select>
                    </div>                    
                </td>

                <td width="35%">
                    <p class="form-label">Control Sequence (optional):
                    <span class="option-group"  style="height:3px;">
                    </span>
                    </p>
                    <select id="controlsequence" name="controlsequence" value="" class="select-group"  style="width:250px;">
                    <option value="" style="width:50px;"></option>
                    {% for controlSeqKit in planTemplateData.controlSeqKits %}
                    {% if selectedApplProductData %}
                        <option value="{{controlSeqKit.name}}">{{controlSeqKit.name}}</option>
                    {% else %}
                        {% ifequal controlSeqKit.name selectedPlanTemplate.controlSequencekitname %}
                            <option SELECTED value="{{controlSeqKit.name}}">{{controlSeqKit.name}}</option>
                        {% else %}
                            <option value="{{controlSeqKit.name}}">{{controlSeqKit.name}}</option>
                        {% endifequal %}
                    {% endif %}
                    {% endfor %}
                    </select>
                </td>
            </tr>
            <tr>
                <td width="65%">
                    <p class="form-label">Sequencing Kit:</p>
                    {% for seqKit in planTemplateData.seqKits %}
                        <input value="{{seqKit.flowCount}}"  id="{{seqKit.name}}" name="{{seqKit.name}}" type="hidden"/>
                    {% endfor %}
                    <select id="sequencekitname" name="sequencekitname" value="" class="select-group" style="width:350px;">
                    <option value=""></option>
                    {% for seqKit in planTemplateData.seqKits %}
                        {% if selectedApplProductData %}
                            {% if selectedApplProductData.isDefaultPairedEnd %}
                                {% ifequal seqKit.name selectedApplProductData.peSeqKit.name %}
                                    <option SELECTED value="{{seqKit.name}}">{{seqKit.description}}</option>
                                {% else %}
                                    <option value="{{seqKit.name}}">{{seqKit.description}}</option>
                                {% endifequal %}
                            {% else %}
                                {% ifequal seqKit.name selectedApplProductData.seqKit.name %}
                                    <option SELECTED value="{{seqKit.name}}">{{seqKit.description}}</option>
                                {% else %}
                                    <option value="{{seqKit.name}}">{{seqKit.description}}</option>
                                {% endifequal %}
                            {% endif %}
                        {% else %}
                            {% ifequal seqKit.name selectedPlanTemplate.sequencekitname %}
                                <option SELECTED value="{{seqKit.name}}">{{seqKit.description}}</option>
                            {% else %}
                                <option value="{{seqKit.name}}">{{seqKit.description}}</option>
                            {% endifequal %}
                        {% endif %}
                    {% endfor %}
                    </select>
                </td>

                <td width="35%">
                    <p class="form-label">Chip Type (optional):</p>
                    <select id="chipType" name="chipType" class="select-group"  style="width:250px;">
                    <option value=""></option>
                    {% for chipType in planTemplateData.chipTypes %}
                        {% if selectedApplProductData %}
                            {% ifequal chipType.name selectedApplProductData.chipType %}
                                <option SELECTED value="{{chipType.name}}">Ion {{chipType.getChipDisplayedName}}&trade; Chip</option>
                            {% else %}
                                <option value="{{chipType.name}}">Ion {{chipType.getChipDisplayedName}}&trade; Chip</option>
                            {% endifequal %}
                        {% else %}
                            {% ifequal chipType.name selectedPlanTemplate.chipType %}
                                <option SELECTED value="{{chipType.name}}">Ion {{chipType.getChipDisplayedName}}&trade; Chip</option>
                            {% else %}
                                <option value="{{chipType.name}}">Ion {{chipType.getChipDisplayedName}}&trade; Chip</option>
                            {% endifequal %}
                        {% endif %}
                    {% endfor %}
                    </select>
                </td>
            </tr>
            <tr>
                <td width="65%">
                    <p class="form-label">Flows:</p>
                    {% if selectedApplProductData %}
                        {% if selectedApplProductData.isDefaultPairedEnd %}
                            {% if selectedApplProductData.peSeqKit %}
                                <input id="flows" name="flows" value="{{selectedApplProductData.peSeqKit.flowCount}}" style="width:50px;">
                            {% else %}
                                <input id="flows" name="flows" value=""style="width:50px;">
                            {% endif %}
                        {% else %}
                            {% if selectedApplProductData.seqKit %}
                                <input id="flows" name="flows" value="{{selectedApplProductData.seqKit.flowCount}}" style="width:50px;">
                            {% else %}
                                <input id="flows" name="flows" value="" style="width:50px;">
                            {% endif %}
                        {% endif %}
                    {% else %}
                        <input id="flows" name="flows" value="{{selectedPlanTemplate.flows}}" style="width:50px;">
                    {% endif %}
                </td>

                <td width="35%">
                	<p class="form-label">Mark as PCR Duplicates: 
                    {% if selectedApplProductData %}
                        {% if globalConfig_isDuplicateReads %}
                        	<input type="checkbox" id="isDuplicateReads" name="isDuplicateReads"  checked="checked" style="vertical-align:top;">                        
                        {% else %}
                        	<input type="checkbox" id="isDuplicateReads" name="isDuplicateReads" style="vertical-align:top;">
                        {% endif %}
                    {% else %}
                        {% if selectedPlanTemplate.isDuplicateReads %}
                            <input type="checkbox" id="isDuplicateReads" name="isDuplicateReads"  checked="checked" style="vertical-align:top;">
                        {% else %}
                            <input type="checkbox" id="isDuplicateReads" name="isDuplicateReads" style="vertical-align:top;">
                        {% endif %}
                    {% endif %}
                    </p>

                </td>
            </tr>
        </table>
        <br>
    </div>
</div>