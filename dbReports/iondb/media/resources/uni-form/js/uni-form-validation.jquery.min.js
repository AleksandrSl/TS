/**
 * Uni-Form jQuery Plugin with Validation
 *
 * Provides form actions for use with the Uni-Form markup style
 * This version adds additional support for client side validation
 *
 * Author: Ilija Studen for the purposes of Uni-Form
 *
 * Modified by Aris Karageorgos to use the parents function
 *
 * Modified by Toni Karlheinz to support input fields' text
 * coloring and removal of their initial values on focus
 *
 * Modified by Jason Brumwell for optimization, addition
 * of valid and invalid states and default data attribues
 *
 * Modified by LearningStation to add support for client
 * side validation routines. The validation routines based on an
 * open source library of unknown authorship.
 *
 * @see http://sprawsm.com/uni-form/
 * @license MIT http://www.opensource.org/licenses/mit-license.php
 *//*jslint devel: true, bitwise: true, browser: true, plusplus: true, maxerr: 50, indent: 4 */jQuery.fn.uniform=function(e){var t=this,n={},r=jQuery.extend(jQuery.fn.uniform.defaults,e),i=jQuery.fn.uniform.language;this.validators={get_val:function(e,t,n){var r=n;t=t.split(" ");for(var i=0;i<t.length;i+=1)if(t[i]===e&&t[i+1]!="undefined"&&"val-"===t[i+1].substr(0,4))return r=parseInt(t[i+1].substr(4),10),r;return r},required:function(e,t){var n;return e.is(":radio")?(n=e.attr("name"),$("input[name="+n+"]:checked").length?!0:o("req_radio",t)):e.is(":checkbox")?(n=e.attr("name"),e.is(":checked")?!0:o("req_checkbox",t)):jQuery.trim(e.val())===""?o("required",t):!0},validateMinLength:function(e,t){var n=this.get_val("validateMinLength",e.attr("class"),0);return n>0&&e.val().length<n?o("minlength",t,n):!0},validateMin:function(e,t){var n=this.get_val("validateMin",e.attr("class"),0);return parseInt(e.val(),10)<n?o("min",t,n):!0},validateMaxLength:function(e,t){var n=this.get_val("validateMaxLength",e.attr("class"),0);return n>0&&e.val().length>n?o("maxlength",t,n):!0},validateMax:function(e,t){var n=this.get_val("validateMax",e.attr("class"),0);return parseInt(e.val(),10)>n?o("max",t,n):!0},validateSameAs:function(e,t){var n=e.attr("class").split(" "),r="",i="",u="";for(var a=0;a<n.length;a+=1)if(n[a]==="validateSameAs"&&n[a+1]!="undefined"){i=n[a+1];break}if(i){var f=e.parents("form:first");r=jQuery('input[name="'+i+'"]',f);if(r.length>0&&r.val()!=e.val())return u=s(r),o("same_as",t,u)}return!0},validateEmail:function(e,t){return e.val().match(/^([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/)?!0:o("email",t)},validateUrl:function(e,t){return e.val().match(/^(http|https|ftp):\/\/(([A-Z0-9][A-Z0-9_\-]*)(\.[A-Z0-9][A-Z0-9_\-]*)+)(:(\d+))?\/?/i)?!0:o("url",t)},validateNumber:function(e,t){return e.val().match(/(^-?\d\d*\.\d*$)|(^-?\d\d*$)|(^-?\.\d\d*$)/)||e.val()===""?!0:o("number",t)},validateInteger:function(e,t){return e.val().match(/(^-?\d\d*$)/)||e.val()===""?!0:o("integer",t)},validateAlpha:function(e,t){return e.val().match(/^[a-zA-Z]+$/)?!0:o("alpha",t)},validateAlphaNum:function(e,t){return e.val()==""?!0:e.val().match(/^[a-zA-Z0-9]+$/)?o("alphanum",t):!0},validatePhrase:function(e,t){return e.val()==""||e.val().match(/^[\w\d\.\-_ ]+$/i)?!0:o("phrase",t)},validatePhone:function(e,t){var n=/^\(?(\d{3})\)?[\- ]?(\d{3})[\- ]?(\d{4})$/;return n.test(e.val())?!0:o("phone",t)},validateDate:function(e,t){return e.val().match("([0]?[1-9]|[1][0-2])/([0]?[1-9]|[1|2][0-9]|[3][0|1])/([0-9]{4}|[0-9]{2})$")?!0:o("date",t)},validateCallback:function(e,t){var n=e.attr("class").split(" "),r="";for(var i=0;i<n.length;i+=1)if(n[i]==="validateCallback"&&n[i+1]!="undefined"){r=n[i+1];break}return window[r]!="undefined"&&typeof window[r]=="function"?window[r](e,t):o("callback",t,r)},validateNuc:function(e,t){barCodeAdd=e.val().toUpperCase();for(var n=0;n<barCodeAdd.length;n++){var r=barCodeAdd.charAt(n);if(r!=="A"&&r!=="T"&&r!=="C"&&r!=="G")return o("nuc",t)}return!0},validateAlphaNumNoSpace:function(e,t){return e.val()==""?!0:e.val().match(/^[a-zA-Z0-9-_\.]+$/)?!0:o("annospace",t)},validateAlphaNumUnderscoreNoSpace:function(e,t){return e.val()==""?!0:e.val().match(/^[a-zA-Z0-9_]+$/)?!0:o("anundernospace",t)},validateIntegerNoZero:function(e,t){return e.val()===""?!0:e.val().match(/(^-?\d\d*$)/)?parseInt(e.val())>0?!0:o("uint",t):o("uint",t)},validateUniq:function(e,t){return isUniq=$.inArray(e.val(),uniq),isUniq===-1?!0:o("uniq",t)},validateHTTPUrl:function(e,t){return e.val().match(/^(http|https):\/\/(([A-Z0-9][A-Z0-9_\-]*)(\.[A-Z0-9][A-Z0-9_\-]*)+)(:(\d+))?\/?/i)?!0:o("url_http",t)},validateFilenameRegex:function(e,t){return e.val().length==0?!0:e.val().match(/^([A-Za-z0-9_\-\/\?\!\*\.\"\']+)/)?!0:o("filenameregex",t)}};var s=function(e){var t=e.closest("label").text();return t===""&&(t=e.closest("div."+r.holder_class).find("label").text()),t.replace("*","").replace(":","")},o=function(e){var t=i[e],n=t.split("%"),r=n[0],s=/^([ds])(.*)$/,o;for(var u=1;u<n.length;u+=1){o=s.exec(n[u]);if(!o||arguments[u]===null)continue;o[1]==="d"?r+=parseInt(arguments[u],10):o[1]==="s"&&(r+=arguments[u]),r+=o[2]}return r};return this.each(function(){var e=jQuery(this),i=function(e,t,i){var s=e.closest("div."+r.holder_class).andSelf().toggleClass(r.invalid_class,!t).toggleClass(r.error_class,!t).toggleClass(r.valid_class,t).find(r.msg_selector);t?name in n&&delete n[name]:n[name]=i,!t&&!s.data("info-text")?s.data("info-text",s.html()):t&&(i=s.data("info-text")),i&&s.html(i)};e.find(r.field_selector).each(function(){var e=$(this),t=e.val();e.data("default-color",e.css("color"));if(t===e.data("default-value")||!t)e.not("select").css("color",r.default_value_color),e.val(e.attr("data-default-value"))});if(r.ask_on_leave||e.hasClass("askOnLeave")){var u=e.serialize();$(window).bind("beforeunload",function(t){if(u!=e.serialize()&&(r.ask_on_leave||e.hasClass("askOnLeave")))return $.isFunction(r.on_leave_callback)?r.on_leave_callback(e):confirm(o("on_leave"))})}e.submit(function(){var t,n=!0;e.removeClass("failedSubmit"),r.ask_on_leave=!1,e.removeClass("askOnLeave"),e.find(r.field_selector).each(function(){$(this).val()===$(this).data("default-value")&&$(this).val("")});if(r.prevent_submit||e.hasClass("preventSubmit")){e.find(r.field_selector).each(function(){$(this).blur()}),$.isFunction(r.submit_callback)&&(n=r.submit_callback(e));if(e.find("."+r.invalid_class).add("."+r.error_class).length||!n)t=$.isFunction(r.prevent_submit_callback)?r.prevent_submit_callback(e,o("submit_msg"),[o("submit_help")]):jQuery.fn.uniform.showFormError(e,o("submit_msg"),[o("submit_help")])}else t=!0;return e.parents("#qunit-fixture").length&&(t=!1),t===!1&&e.addClass("failedSubmit"),t}),e.delegate(r.field_selector,"focus",function(){e.find("."+r.focused_class).removeClass(r.focused_class);var t=$(this);t.parents().filter("."+r.holder_class+":first").addClass(r.focused_class),t.val()===t.data("default-value")&&t.val(""),t.not("select").css("color",t.data("default-color"))}),e.delegate(r.field_selector,"blur",function(){var n=$(this),i=!1,o,u=s($(this));e.find("."+r.focused_class).removeClass(r.focused_class);if(n.val()===n.data("default-value")&&!n.hasClass("required")){n.not("select").css("color",r.default_value_color),n.val(n.data("default-value"));return}for(o in t.validators)if(n.hasClass(o)){i=!0;var a=t.validators[o](n,u);if(typeof a=="string"){n.trigger("error",a);return}}i&&n.trigger("success"),n.css("color",n.data("default-color"));return}),e.delegate(r.field_selector,"error",function(e,t){i($(this),!1,t)}),e.delegate(r.field_selector,"success",function(e,t){i($(this),!0)}),$("input[autofocus]:first").focus()})},jQuery.fn.uniform.showFormError=function(e,t,n){var r,i;$("#errorMsg").length&&$("#errorMsg").remove(),i=$("<div />").attr("id","errorMsg").html("<h3>"+t+"</h3>");if(n.length){i.append($("<ol />"));for(r in n)$("ol",i).append($("<li />").text(n[r]))}return e.prepend(i),$("html, body").animate({scrollTop:e.offset().top},500),$("#errorMsg").slideDown(),!1},jQuery.fn.uniform.showFormSuccess=function(e,t){var n;return $("#okMsg").length&&$("#okMsg").remove(),n=$("<div />").attr("id","okMsg").html("<h3>"+t+"</h3>"),e.prepend(n),$("html, body").animate({scrollTop:e.offset().top},500),$("#okMsg").slideDown(),!1},jQuery.fn.uniform.isValid=function(e,t){return e.find(t.field_selector).each(function(){$(this).blur()}),0===e.find("."+t.invalid_class).add("."+t.error_class).length},jQuery.fn.uniform.language={required:"",req_radio:"Please make a selection",req_checkbox:"You must select this checkbox to continue",minlength:"%s should be at least %d characters long",min:"%s should be greater than or equal to %d",maxlength:"%s should not be longer than %d characters",max:"%s should be less than or equal to %d",same_as:"%s is expected to be same as %s",email:"%s is not a valid email address",url:"%s is not a valid URL",number:"%s needs to be a number",integer:"%s needs to be a whole number",alpha:"%s should contain only letters (without special characters or numbers)",alphanum:"%s should contain only numbers and letters (without special characters)",phrase:"%s should contain only alphabetic characters, numbers, spaces, and the following: . - _ ",phone:"%s should be a phone number",date:"%s should be a date (mm/dd/yyyy)",callback:"Failed to validate %s field. Validator function (%s) is not defined!",on_leave:"Are you sure you want to leave this page without saving this form?",submit_msg:"Sorry, this form needs corrections.",submit_help:"Please see the items marked below.",submit_success:"Thank you, this form has been sent.",nuc:"%s needs to be one of the following:  A, T, C, G",annospace:"%s should contain only numbers, letters, and the following: . - _ ",anundernospace:"%s should contain only numbers, letters or underscore.",uint:"%s needs to be a whole number greater than 0",uniq:"%s is already in use, please enter another barcode id",url_http:"%s is not a valid HTTP-based URL. Must begin with http:// or https://.",filenameregex:"%s is not a valid pattern.  Allowable characters include (comma-separated): A-Z,a-z,0-9,_,-,/,?.,!,*,."},jQuery.fn.uniform.defaults={submit_callback:!1,prevent_submit:!1,prevent_submit_callback:!1,ask_on_leave:!1,on_leave_callback:!1,valid_class:"valid",invalid_class:"invalid",error_class:"error",focused_class:"focused",holder_class:"ctrlHolder",field_selector:"input, textarea, select",default_value_color:"#AFAFAF",msg_selector:"p.formHint"};